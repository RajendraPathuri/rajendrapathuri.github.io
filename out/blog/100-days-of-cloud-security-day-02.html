<!DOCTYPE html><!--T3D1rtAHkxDRBIUJfY_F3--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/440a8f778eae53e9.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-ca8ebae7f954b22a.js"/><script src="/_next/static/chunks/4bd1b696-21f374d1156f834a.js" async=""></script><script src="/_next/static/chunks/255-87b65d3beb72be65.js" async=""></script><script src="/_next/static/chunks/main-app-105e7bfa05751db9.js" async=""></script><script src="/_next/static/chunks/909-740805674b8356ef.js" async=""></script><script src="/_next/static/chunks/619-ba102abea3e3d0e4.js" async=""></script><script src="/_next/static/chunks/451-c2def8cce98c3140.js" async=""></script><script src="/_next/static/chunks/app/layout-98c332aef2240fe1.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-586f9b997c6ba5d5.js" async=""></script><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""/><title>100 Days of Cloud Security - Day 2: Defend | Gitfolio Blogger</title><meta name="description" content="Day 2 of my cloud security journey - Defend"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="32x32"/><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&amp;family=Fira+Code:wght@400;700&amp;family=Orbitron:wght@400;700&amp;display=swap" rel="stylesheet"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="font-body antialiased min-h-screen bg-background text-foreground"><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("class","theme","system",null,["light","dark"],null,true,true)</script><div class="relative flex min-h-dvh flex-col"><header class="sticky top-0 z-50 w-full border-b border-border/40 bg-background/80 backdrop-blur-md supports-[backdrop-filter]:bg-background/60"><div class="w-full px-4 md:px-8 flex h-16 items-center justify-between"><a class="flex items-center gap-2" href="/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cloud-lightning h-6 w-6 text-primary"><path d="M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973"></path><path d="m13 12-3 5h4l-3 5"></path></svg><span class="font-cyber text-xl font-bold text-primary">x0vrpp</span></a><div class="flex items-center gap-6"><nav class="hidden md:flex items-center gap-6"><a class="transition-all relative text-lg md:text-sm px-2 py-1 rounded-md hover:text-primary hover:bg-primary/10 hover:shadow-[0_0_10px_rgba(var(--primary),0.5)] text-muted-foreground" href="/">About Me</a><a class="transition-all relative text-lg md:text-sm px-2 py-1 rounded-md hover:text-primary hover:bg-primary/10 hover:shadow-[0_0_10px_rgba(var(--primary),0.5)] text-muted-foreground" href="/certifications">Certifications</a><a class="transition-all relative text-lg md:text-sm px-2 py-1 rounded-md hover:text-primary hover:bg-primary/10 hover:shadow-[0_0_10px_rgba(var(--primary),0.5)] text-muted-foreground" href="/projects">Projects</a><a class="transition-all relative text-lg md:text-sm px-2 py-1 rounded-md hover:text-primary hover:bg-primary/10 hover:shadow-[0_0_10px_rgba(var(--primary),0.5)] text-primary font-bold shadow-[0_0_15px_rgba(var(--primary),0.6)]" href="/blog">Blog<span class="absolute -bottom-1 left-0 w-full h-[2px] bg-primary shadow-[0_0_10px_var(--primary)] hidden md:block animate-pulse"></span></a></nav><div class="hidden md:block"><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground h-9 w-9 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg><span class="sr-only">Toggle theme</span></button></div><div class="flex items-center md:hidden gap-4"><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground h-9 w-9 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg><span class="sr-only">Toggle theme</span></button><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground h-10 w-10" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-_R_n5lb_" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu h-6 w-6"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg><span class="sr-only">Open Menu</span></button></div></div></div></header><main class="flex-1 container flex flex-col py-4 md:py-8"><article class="max-w-4xl mx-auto px-4 py-8"><header class="mb-8 text-center"><h1 class="font-headline text-3xl md:text-5xl font-bold text-primary mb-3">100 Days of Cloud Security - Day 2: Defend</h1><div class="text-muted-foreground text-sm md:text-base"><span>By <!-- -->Venkata Pathuri<!-- --> on </span><time dateTime="2025-11-11">November 11, 2025</time></div></header><div data-orientation="horizontal" role="none" class="shrink-0 bg-border h-[1px] w-full my-8"></div><div class="prose prose-lg dark:prose-invert max-w-none prose-headings:text-primary prose-a:text-primary"><h1>Day 2: Defend</h1>
<h2>Overview</h2>
<p>Welcome back to my cloud security journey! Yesterday, we explored the attack vectors that can compromise cloud environments, focusing on the vulnerabilities that attackers exploit. Today, we shift gears from offense to defense, diving into practical strategies that can protect our AWS environments from privilege escalation attacks. By defending against the vulnerabilities we uncovered, we can build a robust security posture for our cloud resources.</p>
<h2>Learning Objectives</h2>
<p>In today's lesson, we will master essential defensive strategies against specific IAM vulnerabilities, focusing on the <code>iam:SetDefaultPolicyVersion</code> abuse. We will learn to restrict dangerous IAM actions, implement logging and monitoring solutions, and create detection rules that enable us to respond swiftly to policy changes. By the end of this session, you'll be equipped with the knowledge to defend your AWS environment effectively and understand the importance of proactive security measures.</p>
<h2>Deep Dive</h2>
<h3>Understanding IAM Policy Vulnerabilities</h3>
<p>In our previous session, we identified a critical vulnerability that allows a non-privileged user, like <code>raynor</code>, to escalate their privileges by manipulating IAM policy versions. Attackers can exploit the permissions associated with actions such as <code>iam:GetPolicyVersion</code> and <code>iam:SetDefaultPolicyVersion</code> to gain unauthorized access to sensitive resources. This misuse underscores the importance of tightly controlling IAM permissions and understanding AWS's policy evaluation model.</p>
<h4>Current Best Practices</h4>
<p>To defend against these types of attacks, AWS recommends several best practices:</p>
<ol>
<li>
<p><strong>Restrict Policy-Version APIs</strong>: Create strict policies that deny non-privileged users the ability to manage IAM policy versions. This can be achieved using a policy like the following:</p>
<pre><code class="language-json">{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "DenyPolicyVersionAccess",
      "Effect": "Deny",
      "Action": [
        "iam:GetPolicyVersion",
        "iam:ListPolicyVersions",
        "iam:CreatePolicyVersion",
        "iam:SetDefaultPolicyVersion"
      ],
      "Resource": "*"
    },
    {
      "Sid": "IAMReadOnlyAccess",
      "Effect": "Allow",
      "Action": [
        "iam:Get*",
        "iam:List*"
      ],
      "Resource": "*"
    }
  ]
}
</code></pre>
<p>This policy effectively denies access to dangerous actions for non-privileged users while allowing read-only actions.</p>
</li>
<li>
<p><strong>Remove Direct User Policy Attachments</strong>: Instead of attaching policies directly to users, leverage IAM groups and roles. By creating a <code>privileged-admins</code> group, you can assign necessary permissions without exposing users to unnecessary risks.</p>
</li>
<li>
<p><strong>Enable Logging &#x26; Auditing</strong>: CloudTrail is vital for tracking changes and monitoring activities in your AWS environment. Ensure it's enabled for all management events, includes log-file validation, and sends logs to CloudWatch for real-time monitoring.</p>
</li>
</ol>
<h3>Visual Description</h3>
<p>When you implement these strategies, your AWS Management Console will reflect a more organized IAM structure. You will see your <code>privileged-admins</code> group populated with the necessary permissions, while individual users like <code>raynor</code> will only have access to what they need. Additionally, CloudTrail logs will provide a comprehensive view of all account activity, empowering you to respond quickly to any suspicious actions.</p>
<h2>Hands-On Practice</h2>
<ol>
<li>
<p><strong>Restrict Policy-Version APIs</strong>: Create an IAM policy with the provided JSON code and apply it either as a permission boundary or an organization-wide Service Control Policy (SCP) to ensure comprehensive enforcement.</p>
</li>
<li>
<p><strong>Remove Direct User Policy Attachments</strong>: Detach the problematic policy from the <code>raynor</code> user and assign them to the <code>privileged-admins</code> group instead. You can do this via the AWS Management Console or AWS CLI.</p>
</li>
<li>
<p><strong>Enable CloudTrail</strong>: If not already set up, navigate to the CloudTrail console, enable logging for all management events, and configure it to deliver logs to a centralized S3 bucket.</p>
</li>
<li>
<p><strong>Set Up CloudWatch Alerts</strong>: Create rules in EventBridge to trigger alerts for any changes to policy versions or unauthorized access attempts to sensitive IAM actions.</p>
</li>
</ol>
<h3>Expected Outcomes</h3>
<p>After completing these tasks, you should have:</p>
<ul>
<li>A restricted IAM environment where non-privileged users cannot manipulate policy versions.</li>
<li>Improved auditing capabilities through CloudTrail and CloudWatch, allowing for real-time monitoring of IAM activities.</li>
</ul>
<h3>Common Troubleshooting Tips</h3>
<ul>
<li>If your CloudTrail logs are not appearing, double-check the configuration settings and ensure that logging is enabled for all regions.</li>
<li>For EventBridge rules, verify that the event pattern correctly matches the actions you want to monitor.</li>
</ul>
<h2>Key Takeaways</h2>
<p>In today's session, we learned that defending against cloud vulnerabilities requires a strategic approach to IAM permissions, robust logging, and continuous monitoring. By implementing strict policies, utilizing groups and roles, and setting up effective auditing mechanisms, we can significantly mitigate the risk of privilege escalation attacks. The importance of understanding AWS's policy evaluation model was highlighted, emphasizing the need for thoughtful policy design to prevent unauthorized access.</p>
<h2>Real-World Applications</h2>
<p>In real-world cloud environments, these strategies are not just theoretical; they are essential components of a comprehensive security posture. Organizations like Netflix and Airbnb employ similar IAM governance practices to ensure that their teams can operate efficiently without compromising security. By appropriately managing IAM permissions and monitoring account activity, businesses can protect their sensitive resources and maintain compliance with industry regulations.</p>
<h2>What's Next?</h2>
<p>As we move into Day 3, we will delve deeper into the world of monitoring and incident response. We will explore the tools and techniques that empower us to detect and respond to threats effectively, building upon the defensive measures we've established today. Get ready for an exciting exploration of how to stay one step ahead of potential threats in your cloud environment!</p>
<hr>
<p><strong>Journey Progress:</strong> 2/100 Days Complete ðŸš€</p>
</div></article><!--$--><!--/$--></main><footer class="border-t"><div class="container flex flex-col items-center justify-center gap-4 py-8 md:h-24 md:flex-row"><div class="flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cloud-lightning h-6 w-6 text-primary"><path d="M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973"></path><path d="m13 12-3 5h4l-3 5"></path></svg><p class="text-center text-sm leading-loose text-muted-foreground md:text-left">Â© <!-- -->2025<!-- --> Venkata Pathuri. All Rights Reserved.</p></div></div></footer></div><div role="region" aria-label="Notifications (F8)" tabindex="-1" style="pointer-events:none"><ol tabindex="-1" class="fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]"></ol></div><script src="/_next/static/chunks/webpack-ca8ebae7f954b22a.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[1458,[\"909\",\"static/chunks/909-740805674b8356ef.js\",\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"451\",\"static/chunks/451-c2def8cce98c3140.js\",\"177\",\"static/chunks/app/layout-98c332aef2240fe1.js\"],\"ThemeProvider\"]\n3:I[6970,[\"909\",\"static/chunks/909-740805674b8356ef.js\",\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"451\",\"static/chunks/451-c2def8cce98c3140.js\",\"177\",\"static/chunks/app/layout-98c332aef2240fe1.js\"],\"default\"]\n4:I[9766,[],\"\"]\n5:I[8924,[],\"\"]\n6:I[704,[\"909\",\"static/chunks/909-740805674b8356ef.js\",\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"451\",\"static/chunks/451-c2def8cce98c3140.js\",\"177\",\"static/chunks/app/layout-98c332aef2240fe1.js\"],\"Toaster\"]\n8:I[4431,[],\"OutletBoundary\"]\na:I[5278,[],\"AsyncMetadataOutlet\"]\nc:I[4431,[],\"ViewportBoundary\"]\ne:I[4431,[],\"MetadataBoundary\"]\nf:\"$Sreact.suspense\"\n11:I[7150,[],\"\"]\n:HL[\"/_next/static/css/440a8f778eae53e9.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"T3D1rtAHkxDRBIUJfY-F3\",\"p\":\"\",\"c\":[\"\",\"blog\",\"100-days-of-cloud-security-day-02\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"100-days-of-cloud-security-day-02\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/440a8f778eae53e9.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.googleapis.com\"}],[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.gstatic.com\",\"crossOrigin\":\"\"}],[\"$\",\"link\",null,{\"href\":\"https://fonts.googleapis.com/css2?family=Inter:wght@400;700\u0026family=Fira+Code:wght@400;700\u0026family=Orbitron:wght@400;700\u0026display=swap\",\"rel\":\"stylesheet\"}]]}],[\"$\",\"body\",null,{\"className\":\"font-body antialiased min-h-screen bg-background text-foreground\",\"children\":[\"$\",\"$L2\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[[\"$\",\"div\",null,{\"className\":\"relative flex min-h-dvh flex-col\",\"children\":[[\"$\",\"$L3\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex-1 container flex flex-col py-4 md:py-8\",\"children\":[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"footer\",null,{\"className\":\"border-t\",\"children\":[\"$\",\"div\",null,{\"className\":\"container flex flex-col items-center justify-center gap-4 py-8 md:h-24 md:flex-row\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-cloud-lightning h-6 w-6 text-primary\",\"children\":[[\"$\",\"path\",\"1cez44\",{\"d\":\"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973\"}],[\"$\",\"path\",\"1t22er\",{\"d\":\"m13 12-3 5h4l-3 5\"}],\"$undefined\"]}],[\"$\",\"p\",null,{\"className\":\"text-center text-sm leading-loose text-muted-foreground md:text-left\",\"children\":[\"Â© \",2025,\" Venkata Pathuri. All Rights Reserved.\"]}]]}]}]}]]}],[\"$\",\"$L6\",null,{}]]}]}]]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"100-days-of-cloud-security-day-02\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L7\",null,[\"$\",\"$L8\",null,{\"children\":[\"$L9\",[\"$\",\"$La\",null,{\"promise\":\"$@b\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],null],[\"$\",\"$Le\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$f\",null,{\"fallback\":null,\"children\":\"$L10\"}]}]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$11\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"12:I[8474,[\"909\",\"static/chunks/909-740805674b8356ef.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-586f9b997c6ba5d5.js\"],\"Separator\"]\n13:T1aaf,"])</script><script>self.__next_f.push([1,"\u003ch1\u003eDay 2: Defend\u003c/h1\u003e\n\u003ch2\u003eOverview\u003c/h2\u003e\n\u003cp\u003eWelcome back to my cloud security journey! Yesterday, we explored the attack vectors that can compromise cloud environments, focusing on the vulnerabilities that attackers exploit. Today, we shift gears from offense to defense, diving into practical strategies that can protect our AWS environments from privilege escalation attacks. By defending against the vulnerabilities we uncovered, we can build a robust security posture for our cloud resources.\u003c/p\u003e\n\u003ch2\u003eLearning Objectives\u003c/h2\u003e\n\u003cp\u003eIn today's lesson, we will master essential defensive strategies against specific IAM vulnerabilities, focusing on the \u003ccode\u003eiam:SetDefaultPolicyVersion\u003c/code\u003e abuse. We will learn to restrict dangerous IAM actions, implement logging and monitoring solutions, and create detection rules that enable us to respond swiftly to policy changes. By the end of this session, you'll be equipped with the knowledge to defend your AWS environment effectively and understand the importance of proactive security measures.\u003c/p\u003e\n\u003ch2\u003eDeep Dive\u003c/h2\u003e\n\u003ch3\u003eUnderstanding IAM Policy Vulnerabilities\u003c/h3\u003e\n\u003cp\u003eIn our previous session, we identified a critical vulnerability that allows a non-privileged user, like \u003ccode\u003eraynor\u003c/code\u003e, to escalate their privileges by manipulating IAM policy versions. Attackers can exploit the permissions associated with actions such as \u003ccode\u003eiam:GetPolicyVersion\u003c/code\u003e and \u003ccode\u003eiam:SetDefaultPolicyVersion\u003c/code\u003e to gain unauthorized access to sensitive resources. This misuse underscores the importance of tightly controlling IAM permissions and understanding AWS's policy evaluation model.\u003c/p\u003e\n\u003ch4\u003eCurrent Best Practices\u003c/h4\u003e\n\u003cp\u003eTo defend against these types of attacks, AWS recommends several best practices:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eRestrict Policy-Version APIs\u003c/strong\u003e: Create strict policies that deny non-privileged users the ability to manage IAM policy versions. This can be achieved using a policy like the following:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-json\"\u003e{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"DenyPolicyVersionAccess\",\n      \"Effect\": \"Deny\",\n      \"Action\": [\n        \"iam:GetPolicyVersion\",\n        \"iam:ListPolicyVersions\",\n        \"iam:CreatePolicyVersion\",\n        \"iam:SetDefaultPolicyVersion\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"IAMReadOnlyAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:Get*\",\n        \"iam:List*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis policy effectively denies access to dangerous actions for non-privileged users while allowing read-only actions.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eRemove Direct User Policy Attachments\u003c/strong\u003e: Instead of attaching policies directly to users, leverage IAM groups and roles. By creating a \u003ccode\u003eprivileged-admins\u003c/code\u003e group, you can assign necessary permissions without exposing users to unnecessary risks.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eEnable Logging \u0026#x26; Auditing\u003c/strong\u003e: CloudTrail is vital for tracking changes and monitoring activities in your AWS environment. Ensure it's enabled for all management events, includes log-file validation, and sends logs to CloudWatch for real-time monitoring.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003eVisual Description\u003c/h3\u003e\n\u003cp\u003eWhen you implement these strategies, your AWS Management Console will reflect a more organized IAM structure. You will see your \u003ccode\u003eprivileged-admins\u003c/code\u003e group populated with the necessary permissions, while individual users like \u003ccode\u003eraynor\u003c/code\u003e will only have access to what they need. Additionally, CloudTrail logs will provide a comprehensive view of all account activity, empowering you to respond quickly to any suspicious actions.\u003c/p\u003e\n\u003ch2\u003eHands-On Practice\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eRestrict Policy-Version APIs\u003c/strong\u003e: Create an IAM policy with the provided JSON code and apply it either as a permission boundary or an organization-wide Service Control Policy (SCP) to ensure comprehensive enforcement.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eRemove Direct User Policy Attachments\u003c/strong\u003e: Detach the problematic policy from the \u003ccode\u003eraynor\u003c/code\u003e user and assign them to the \u003ccode\u003eprivileged-admins\u003c/code\u003e group instead. You can do this via the AWS Management Console or AWS CLI.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eEnable CloudTrail\u003c/strong\u003e: If not already set up, navigate to the CloudTrail console, enable logging for all management events, and configure it to deliver logs to a centralized S3 bucket.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eSet Up CloudWatch Alerts\u003c/strong\u003e: Create rules in EventBridge to trigger alerts for any changes to policy versions or unauthorized access attempts to sensitive IAM actions.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003eExpected Outcomes\u003c/h3\u003e\n\u003cp\u003eAfter completing these tasks, you should have:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eA restricted IAM environment where non-privileged users cannot manipulate policy versions.\u003c/li\u003e\n\u003cli\u003eImproved auditing capabilities through CloudTrail and CloudWatch, allowing for real-time monitoring of IAM activities.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eCommon Troubleshooting Tips\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eIf your CloudTrail logs are not appearing, double-check the configuration settings and ensure that logging is enabled for all regions.\u003c/li\u003e\n\u003cli\u003eFor EventBridge rules, verify that the event pattern correctly matches the actions you want to monitor.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eKey Takeaways\u003c/h2\u003e\n\u003cp\u003eIn today's session, we learned that defending against cloud vulnerabilities requires a strategic approach to IAM permissions, robust logging, and continuous monitoring. By implementing strict policies, utilizing groups and roles, and setting up effective auditing mechanisms, we can significantly mitigate the risk of privilege escalation attacks. The importance of understanding AWS's policy evaluation model was highlighted, emphasizing the need for thoughtful policy design to prevent unauthorized access.\u003c/p\u003e\n\u003ch2\u003eReal-World Applications\u003c/h2\u003e\n\u003cp\u003eIn real-world cloud environments, these strategies are not just theoretical; they are essential components of a comprehensive security posture. Organizations like Netflix and Airbnb employ similar IAM governance practices to ensure that their teams can operate efficiently without compromising security. By appropriately managing IAM permissions and monitoring account activity, businesses can protect their sensitive resources and maintain compliance with industry regulations.\u003c/p\u003e\n\u003ch2\u003eWhat's Next?\u003c/h2\u003e\n\u003cp\u003eAs we move into Day 3, we will delve deeper into the world of monitoring and incident response. We will explore the tools and techniques that empower us to detect and respond to threats effectively, building upon the defensive measures we've established today. Get ready for an exciting exploration of how to stay one step ahead of potential threats in your cloud environment!\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cstrong\u003eJourney Progress:\u003c/strong\u003e 2/100 Days Complete ðŸš€\u003c/p\u003e\n"])</script><script>self.__next_f.push([1,"7:[\"$\",\"article\",null,{\"className\":\"max-w-4xl mx-auto px-4 py-8\",\"children\":[[\"$\",\"header\",null,{\"className\":\"mb-8 text-center\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"font-headline text-3xl md:text-5xl font-bold text-primary mb-3\",\"children\":\"100 Days of Cloud Security - Day 2: Defend\"}],[\"$\",\"div\",null,{\"className\":\"text-muted-foreground text-sm md:text-base\",\"children\":[[\"$\",\"span\",null,{\"children\":[\"By \",\"Venkata Pathuri\",\" on \"]}],[\"$\",\"time\",null,{\"dateTime\":\"2025-11-11\",\"children\":\"November 11, 2025\"}]]}]]}],[\"$\",\"$L12\",null,{\"className\":\"my-8\"}],[\"$\",\"div\",null,{\"className\":\"prose prose-lg dark:prose-invert max-w-none prose-headings:text-primary prose-a:text-primary\",\"dangerouslySetInnerHTML\":{\"__html\":\"$13\"}}]]}]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n9:null\n"])</script><script>self.__next_f.push([1,"14:I[622,[],\"IconMark\"]\nb:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"100 Days of Cloud Security - Day 2: Defend | Gitfolio Blogger\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Day 2 of my cloud security journey - Defend\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"32x32\"}],[\"$\",\"$L14\",\"3\",{}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"10:\"$b:metadata\"\n"])</script></body></html>