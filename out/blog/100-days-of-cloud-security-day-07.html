<!DOCTYPE html><!--JMtuDo3EXuReSaRmaYdn1--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/646ef98856fbea42.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-ca8ebae7f954b22a.js"/><script src="/_next/static/chunks/4bd1b696-21f374d1156f834a.js" async=""></script><script src="/_next/static/chunks/255-87b65d3beb72be65.js" async=""></script><script src="/_next/static/chunks/main-app-105e7bfa05751db9.js" async=""></script><script src="/_next/static/chunks/619-ba102abea3e3d0e4.js" async=""></script><script src="/_next/static/chunks/909-740805674b8356ef.js" async=""></script><script src="/_next/static/chunks/451-c2def8cce98c3140.js" async=""></script><script src="/_next/static/chunks/app/layout-870cdc0898a1f2e6.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-586f9b997c6ba5d5.js" async=""></script><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""/><title>100 Days of Cloud Security - Day 7: Attack â€” `lambda_privesc` | Gitfolio Blogger</title><meta name="description" content="Day 7 of my cloud security journey - Attack â€” `lambda_privesc`"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="32x32"/><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&amp;family=Fira+Code:wght@400;700&amp;family=Orbitron:wght@400;700&amp;display=swap" rel="stylesheet"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="font-body antialiased min-h-screen bg-background text-foreground"><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("class","theme","system",null,["light","dark"],null,true,true)</script><div class="relative flex min-h-dvh flex-col"><header class="sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60"><div class="w-full px-4 md:px-8 flex h-16 items-center justify-between"><a class="flex items-center gap-2" href="/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cloud-lightning h-6 w-6 text-primary"><path d="M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973"></path><path d="m13 12-3 5h4l-3 5"></path></svg><span class="font-cyber text-xl font-bold text-primary">x0vrpp</span></a><div class="flex items-center gap-6"><nav class="hidden md:flex items-center gap-6"><a class="transition-colors relative text-lg md:text-sm hover:text-primary text-muted-foreground" href="/">About Me</a><a class="transition-colors relative text-lg md:text-sm hover:text-primary text-muted-foreground" href="/certifications">Certifications</a><a class="transition-colors relative text-lg md:text-sm hover:text-primary text-muted-foreground" href="/projects">Projects</a><a class="transition-colors relative text-lg md:text-sm hover:text-primary text-primary font-semibold" href="/blog">Blog<span class="absolute -bottom-2 left-1/2 -translate-x-1/2 w-2 h-2 rounded-full bg-primary hidden md:block"></span></a></nav><div class="hidden md:block"><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground h-9 w-9 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg><span class="sr-only">Toggle theme</span></button></div><div class="flex items-center md:hidden gap-4"><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground h-9 w-9 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg><span class="sr-only">Toggle theme</span></button><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground h-10 w-10" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-_R_n5lb_" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu h-6 w-6"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg><span class="sr-only">Open Menu</span></button></div></div></div></header><main class="flex-1 container py-10"><article class="max-w-4xl mx-auto px-4 py-8"><header class="mb-8 text-center"><h1 class="font-headline text-3xl md:text-5xl font-bold text-primary mb-3">100 Days of Cloud Security - Day 7: Attack â€” `lambda_privesc`</h1><div class="text-muted-foreground text-sm md:text-base"><span>By <!-- -->Venkata Pathuri<!-- --> on </span><time dateTime="2025-11-16">November 16, 2025</time></div></header><div data-orientation="horizontal" role="none" class="shrink-0 bg-border h-[1px] w-full my-8"></div><div class="prose prose-lg dark:prose-invert max-w-none prose-headings:text-primary prose-a:text-primary"><h1>Day 7: Attack â€” <code>lambda_privesc</code></h1>
<h2>Overview</h2>
<p>Welcome back to Day 7 of our cloud security journey! Building on our foundational knowledge from Day 6, where we explored various IAM roles and permissions, today we delve into an exciting hands-on scenario: attacking the <code>lambda_privesc</code> CloudGoat lab. This exercise not only sharpens our enumeration and exploitation skills but also emphasizes the critical nature of permissions management within AWS environments. By the end of today, you'll gain a solid understanding of how privilege escalation can occur through AWS Lambda functions.</p>
<h2>Learning Objectives</h2>
<p>Today, we aim to master the process of identifying attack vectors through enumeration, exploiting those vectors, and ultimately achieving elevated privileges within an AWS environment. You'll learn how to effectively utilize AWS IAM roles and policies, understand the implications of <code>iam:PassRole</code>, and employ Lambda functions to execute actions that can lead to administrative access. This exercise will empower you with practical skills that are vital in real-world cloud security assessments.</p>
<h2>Deep Dive</h2>
<h3>Enumeration: The First Step in Cloud Penetration Testing</h3>
<p>The first phase of any penetration test is enumeration, where we gather as much information as possible about the environment. In our case, we logged in as the user <code>chris-cgide3k5k2fwj7</code>, who has a managed policy allowing actions like <code>sts:AssumeRole</code>, <code>iam:List*</code>, and <code>iam:Get*</code>. This access is crucial; it hints at possible exploit paths, particularly the ability to assume roles that could grant broader permissions.</p>
<p>In our enumeration, we discovered two roles: <code>cg-debug-role-cgide3k5k2fwj7</code>, which has <code>AdministratorAccess</code>, and <code>cg-lambdaManager-role-cgide3k5k2fwj7</code>, which allows the user to manage Lambda functions and pass roles. The latter role's permissions, especially <code>iam:PassRole</code>, can be particularly powerful when misconfigured, as it enables users to execute code with elevated permissions.</p>
<h3>Exploitation and Privilege Escalation</h3>
<p>After identifying potential roles, the next step is to exploit these findings. By assuming the <code>cg-lambdaManager-role-cgide3k5k2fwj7</code> role, we can create a Lambda function that uses the <code>cg-debug-role</code>, thus gaining administrative privileges.</p>
<p>The Lambda function we deployed was simple yet effective. It was coded to attach the <code>AdministratorAccess</code> policy to our user, leveraging the elevated permissions provided by the <code>cg-debug-role</code>. This highlights an essential concept: <strong>the power of serverless architecture</strong>. Lambda functions can be triggered to perform actions across AWS services without needing a dedicated server, which can be both a boon and a bane in terms of security.</p>
<h3>Best Practices in IAM and Lambda Security</h3>
<p>To mitigate risks associated with privilege escalation, adhere to these best practices:</p>
<ul>
<li><strong>Principle of Least Privilege</strong>: Always grant the minimum permissions necessary for users and roles to perform their tasks.</li>
<li><strong>Regular Auditing</strong>: Periodically review IAM roles and policies to ensure they align with your organizational security posture.</li>
<li><strong>Use of Conditions in Policies</strong>: Implement conditions in IAM policies to enforce context-aware access controls, such as IP restrictions.</li>
</ul>
<h2>Hands-On Practice</h2>
<p>Let's go through the hands-on steps you took today:</p>
<ol>
<li>
<p><strong>Initial Enumeration</strong>: You logged in and checked the permissions and roles attached to your user account. Using commands like <code>aws iam list-attached-role-policies</code>, you identified roles and their permissions.</p>
</li>
<li>
<p><strong>Assuming the Role</strong>: You used the <code>aws sts assume-role</code> command to switch to the <code>cg-lambdaManager-role-cgide3k5k2fwj7</code>, which allowed you to gain temporary credentials for further actions.</p>
</li>
<li>
<p><strong>Creating and Invoking Lambda</strong>: After packaging your Lambda function into a zip file, you created the function with the <code>aws lambda create-function</code> command, specifying the <code>cg-debug-role</code> as the execution role. You invoked the function using <code>aws lambda invoke</code>, which successfully attached the <code>AdministratorAccess</code> policy to your user.</p>
</li>
<li>
<p><strong>Verification</strong>: By listing the attached policies on your user account, you confirmed the successful privilege escalation.</p>
</li>
</ol>
<h3>Common Troubleshooting Tips</h3>
<ul>
<li>If you encounter permission errors while assuming roles, double-check the trust relationships in the role's policy to ensure your user is allowed to assume it.</li>
<li>Always verify that your Lambda function has the correct execution role assigned; this is crucial for it to perform actions on your behalf.</li>
</ul>
<h2>Key Takeaways</h2>
<p>Todayâ€™s exercise reinforced the importance of understanding IAM roles, policies, and the power of AWS Lambda in executing actions at scale. By successfully navigating the process from enumeration to exploitation, you have gained not only technical skills but also insights into the potential pitfalls of misconfigured permissions. Remember, while AWS offers powerful tools for managing resources, the responsibility lies with us to ensure they are secured against unauthorized access.</p>
<h2>Real-World Applications</h2>
<p>In production environments, the lessons learned from today's exercise are invaluable. Organizations often face similar scenarios where users may inadvertently or maliciously exploit overly permissive IAM roles. Understanding how these attacks can unfold enables security teams to better prepare and defend against such threats. Regularly auditing IAM permissions and educating teams on secure coding practices for serverless architectures like AWS Lambda helps maintain a strong security posture.</p>
<hr>
<p><strong>Journey Progress:</strong> 7/100 Days Complete ðŸš€</p>
</div></article><!--$--><!--/$--></main><footer class="border-t"><div class="container flex flex-col items-center justify-center gap-4 py-8 md:h-24 md:flex-row"><div class="flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cloud-lightning h-6 w-6 text-primary"><path d="M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973"></path><path d="m13 12-3 5h4l-3 5"></path></svg><p class="text-center text-sm leading-loose text-muted-foreground md:text-left">Â© <!-- -->2025<!-- --> Venkata Pathuri. All Rights Reserved.</p></div></div></footer></div><div role="region" aria-label="Notifications (F8)" tabindex="-1" style="pointer-events:none"><ol tabindex="-1" class="fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]"></ol></div><script src="/_next/static/chunks/webpack-ca8ebae7f954b22a.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[1458,[\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"909\",\"static/chunks/909-740805674b8356ef.js\",\"451\",\"static/chunks/451-c2def8cce98c3140.js\",\"177\",\"static/chunks/app/layout-870cdc0898a1f2e6.js\"],\"ThemeProvider\"]\n3:I[6970,[\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"909\",\"static/chunks/909-740805674b8356ef.js\",\"451\",\"static/chunks/451-c2def8cce98c3140.js\",\"177\",\"static/chunks/app/layout-870cdc0898a1f2e6.js\"],\"default\"]\n4:I[9766,[],\"\"]\n5:I[8924,[],\"\"]\n6:I[704,[\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"909\",\"static/chunks/909-740805674b8356ef.js\",\"451\",\"static/chunks/451-c2def8cce98c3140.js\",\"177\",\"static/chunks/app/layout-870cdc0898a1f2e6.js\"],\"Toaster\"]\n8:I[4431,[],\"OutletBoundary\"]\na:I[5278,[],\"AsyncMetadataOutlet\"]\nc:I[4431,[],\"ViewportBoundary\"]\ne:I[4431,[],\"MetadataBoundary\"]\nf:\"$Sreact.suspense\"\n11:I[7150,[],\"\"]\n:HL[\"/_next/static/css/646ef98856fbea42.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"JMtuDo3EXuReSaRmaYdn1\",\"p\":\"\",\"c\":[\"\",\"blog\",\"100-days-of-cloud-security-day-07\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"100-days-of-cloud-security-day-07\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/646ef98856fbea42.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.googleapis.com\"}],[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.gstatic.com\",\"crossOrigin\":\"\"}],[\"$\",\"link\",null,{\"href\":\"https://fonts.googleapis.com/css2?family=Inter:wght@400;700\u0026family=Fira+Code:wght@400;700\u0026family=Orbitron:wght@400;700\u0026display=swap\",\"rel\":\"stylesheet\"}]]}],[\"$\",\"body\",null,{\"className\":\"font-body antialiased min-h-screen bg-background text-foreground\",\"children\":[\"$\",\"$L2\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[[\"$\",\"div\",null,{\"className\":\"relative flex min-h-dvh flex-col\",\"children\":[[\"$\",\"$L3\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex-1 container py-10\",\"children\":[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"footer\",null,{\"className\":\"border-t\",\"children\":[\"$\",\"div\",null,{\"className\":\"container flex flex-col items-center justify-center gap-4 py-8 md:h-24 md:flex-row\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-cloud-lightning h-6 w-6 text-primary\",\"children\":[[\"$\",\"path\",\"1cez44\",{\"d\":\"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973\"}],[\"$\",\"path\",\"1t22er\",{\"d\":\"m13 12-3 5h4l-3 5\"}],\"$undefined\"]}],[\"$\",\"p\",null,{\"className\":\"text-center text-sm leading-loose text-muted-foreground md:text-left\",\"children\":[\"Â© \",2025,\" Venkata Pathuri. All Rights Reserved.\"]}]]}]}]}]]}],[\"$\",\"$L6\",null,{}]]}]}]]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"100-days-of-cloud-security-day-07\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L7\",null,[\"$\",\"$L8\",null,{\"children\":[\"$L9\",[\"$\",\"$La\",null,{\"promise\":\"$@b\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],null],[\"$\",\"$Le\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$f\",null,{\"fallback\":null,\"children\":\"$L10\"}]}]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$11\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"12:I[8474,[\"909\",\"static/chunks/909-740805674b8356ef.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-586f9b997c6ba5d5.js\"],\"Separator\"]\n13:T186a,"])</script><script>self.__next_f.push([1,"\u003ch1\u003eDay 7: Attack â€” \u003ccode\u003elambda_privesc\u003c/code\u003e\u003c/h1\u003e\n\u003ch2\u003eOverview\u003c/h2\u003e\n\u003cp\u003eWelcome back to Day 7 of our cloud security journey! Building on our foundational knowledge from Day 6, where we explored various IAM roles and permissions, today we delve into an exciting hands-on scenario: attacking the \u003ccode\u003elambda_privesc\u003c/code\u003e CloudGoat lab. This exercise not only sharpens our enumeration and exploitation skills but also emphasizes the critical nature of permissions management within AWS environments. By the end of today, you'll gain a solid understanding of how privilege escalation can occur through AWS Lambda functions.\u003c/p\u003e\n\u003ch2\u003eLearning Objectives\u003c/h2\u003e\n\u003cp\u003eToday, we aim to master the process of identifying attack vectors through enumeration, exploiting those vectors, and ultimately achieving elevated privileges within an AWS environment. You'll learn how to effectively utilize AWS IAM roles and policies, understand the implications of \u003ccode\u003eiam:PassRole\u003c/code\u003e, and employ Lambda functions to execute actions that can lead to administrative access. This exercise will empower you with practical skills that are vital in real-world cloud security assessments.\u003c/p\u003e\n\u003ch2\u003eDeep Dive\u003c/h2\u003e\n\u003ch3\u003eEnumeration: The First Step in Cloud Penetration Testing\u003c/h3\u003e\n\u003cp\u003eThe first phase of any penetration test is enumeration, where we gather as much information as possible about the environment. In our case, we logged in as the user \u003ccode\u003echris-cgide3k5k2fwj7\u003c/code\u003e, who has a managed policy allowing actions like \u003ccode\u003ests:AssumeRole\u003c/code\u003e, \u003ccode\u003eiam:List*\u003c/code\u003e, and \u003ccode\u003eiam:Get*\u003c/code\u003e. This access is crucial; it hints at possible exploit paths, particularly the ability to assume roles that could grant broader permissions.\u003c/p\u003e\n\u003cp\u003eIn our enumeration, we discovered two roles: \u003ccode\u003ecg-debug-role-cgide3k5k2fwj7\u003c/code\u003e, which has \u003ccode\u003eAdministratorAccess\u003c/code\u003e, and \u003ccode\u003ecg-lambdaManager-role-cgide3k5k2fwj7\u003c/code\u003e, which allows the user to manage Lambda functions and pass roles. The latter role's permissions, especially \u003ccode\u003eiam:PassRole\u003c/code\u003e, can be particularly powerful when misconfigured, as it enables users to execute code with elevated permissions.\u003c/p\u003e\n\u003ch3\u003eExploitation and Privilege Escalation\u003c/h3\u003e\n\u003cp\u003eAfter identifying potential roles, the next step is to exploit these findings. By assuming the \u003ccode\u003ecg-lambdaManager-role-cgide3k5k2fwj7\u003c/code\u003e role, we can create a Lambda function that uses the \u003ccode\u003ecg-debug-role\u003c/code\u003e, thus gaining administrative privileges.\u003c/p\u003e\n\u003cp\u003eThe Lambda function we deployed was simple yet effective. It was coded to attach the \u003ccode\u003eAdministratorAccess\u003c/code\u003e policy to our user, leveraging the elevated permissions provided by the \u003ccode\u003ecg-debug-role\u003c/code\u003e. This highlights an essential concept: \u003cstrong\u003ethe power of serverless architecture\u003c/strong\u003e. Lambda functions can be triggered to perform actions across AWS services without needing a dedicated server, which can be both a boon and a bane in terms of security.\u003c/p\u003e\n\u003ch3\u003eBest Practices in IAM and Lambda Security\u003c/h3\u003e\n\u003cp\u003eTo mitigate risks associated with privilege escalation, adhere to these best practices:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003ePrinciple of Least Privilege\u003c/strong\u003e: Always grant the minimum permissions necessary for users and roles to perform their tasks.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRegular Auditing\u003c/strong\u003e: Periodically review IAM roles and policies to ensure they align with your organizational security posture.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eUse of Conditions in Policies\u003c/strong\u003e: Implement conditions in IAM policies to enforce context-aware access controls, such as IP restrictions.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eHands-On Practice\u003c/h2\u003e\n\u003cp\u003eLet's go through the hands-on steps you took today:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eInitial Enumeration\u003c/strong\u003e: You logged in and checked the permissions and roles attached to your user account. Using commands like \u003ccode\u003eaws iam list-attached-role-policies\u003c/code\u003e, you identified roles and their permissions.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eAssuming the Role\u003c/strong\u003e: You used the \u003ccode\u003eaws sts assume-role\u003c/code\u003e command to switch to the \u003ccode\u003ecg-lambdaManager-role-cgide3k5k2fwj7\u003c/code\u003e, which allowed you to gain temporary credentials for further actions.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eCreating and Invoking Lambda\u003c/strong\u003e: After packaging your Lambda function into a zip file, you created the function with the \u003ccode\u003eaws lambda create-function\u003c/code\u003e command, specifying the \u003ccode\u003ecg-debug-role\u003c/code\u003e as the execution role. You invoked the function using \u003ccode\u003eaws lambda invoke\u003c/code\u003e, which successfully attached the \u003ccode\u003eAdministratorAccess\u003c/code\u003e policy to your user.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eVerification\u003c/strong\u003e: By listing the attached policies on your user account, you confirmed the successful privilege escalation.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003eCommon Troubleshooting Tips\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eIf you encounter permission errors while assuming roles, double-check the trust relationships in the role's policy to ensure your user is allowed to assume it.\u003c/li\u003e\n\u003cli\u003eAlways verify that your Lambda function has the correct execution role assigned; this is crucial for it to perform actions on your behalf.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eKey Takeaways\u003c/h2\u003e\n\u003cp\u003eTodayâ€™s exercise reinforced the importance of understanding IAM roles, policies, and the power of AWS Lambda in executing actions at scale. By successfully navigating the process from enumeration to exploitation, you have gained not only technical skills but also insights into the potential pitfalls of misconfigured permissions. Remember, while AWS offers powerful tools for managing resources, the responsibility lies with us to ensure they are secured against unauthorized access.\u003c/p\u003e\n\u003ch2\u003eReal-World Applications\u003c/h2\u003e\n\u003cp\u003eIn production environments, the lessons learned from today's exercise are invaluable. Organizations often face similar scenarios where users may inadvertently or maliciously exploit overly permissive IAM roles. Understanding how these attacks can unfold enables security teams to better prepare and defend against such threats. Regularly auditing IAM permissions and educating teams on secure coding practices for serverless architectures like AWS Lambda helps maintain a strong security posture.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cstrong\u003eJourney Progress:\u003c/strong\u003e 7/100 Days Complete ðŸš€\u003c/p\u003e\n"])</script><script>self.__next_f.push([1,"7:[\"$\",\"article\",null,{\"className\":\"max-w-4xl mx-auto px-4 py-8\",\"children\":[[\"$\",\"header\",null,{\"className\":\"mb-8 text-center\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"font-headline text-3xl md:text-5xl font-bold text-primary mb-3\",\"children\":\"100 Days of Cloud Security - Day 7: Attack â€” `lambda_privesc`\"}],[\"$\",\"div\",null,{\"className\":\"text-muted-foreground text-sm md:text-base\",\"children\":[[\"$\",\"span\",null,{\"children\":[\"By \",\"Venkata Pathuri\",\" on \"]}],[\"$\",\"time\",null,{\"dateTime\":\"2025-11-16\",\"children\":\"November 16, 2025\"}]]}]]}],[\"$\",\"$L12\",null,{\"className\":\"my-8\"}],[\"$\",\"div\",null,{\"className\":\"prose prose-lg dark:prose-invert max-w-none prose-headings:text-primary prose-a:text-primary\",\"dangerouslySetInnerHTML\":{\"__html\":\"$13\"}}]]}]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n9:null\n"])</script><script>self.__next_f.push([1,"14:I[622,[],\"IconMark\"]\nb:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"100 Days of Cloud Security - Day 7: Attack â€” `lambda_privesc` | Gitfolio Blogger\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Day 7 of my cloud security journey - Attack â€” `lambda_privesc`\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"32x32\"}],[\"$\",\"$L14\",\"3\",{}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"10:\"$b:metadata\"\n"])</script></body></html>