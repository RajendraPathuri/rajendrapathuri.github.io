<!DOCTYPE html><!--T3D1rtAHkxDRBIUJfY_F3--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/440a8f778eae53e9.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-ca8ebae7f954b22a.js"/><script src="/_next/static/chunks/4bd1b696-21f374d1156f834a.js" async=""></script><script src="/_next/static/chunks/255-87b65d3beb72be65.js" async=""></script><script src="/_next/static/chunks/main-app-105e7bfa05751db9.js" async=""></script><script src="/_next/static/chunks/909-740805674b8356ef.js" async=""></script><script src="/_next/static/chunks/619-ba102abea3e3d0e4.js" async=""></script><script src="/_next/static/chunks/451-c2def8cce98c3140.js" async=""></script><script src="/_next/static/chunks/app/layout-98c332aef2240fe1.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-586f9b997c6ba5d5.js" async=""></script><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""/><title>100 Days of Cloud Security - Day 10: Defend Reports for Day 7 - `lambda_privesc` | Gitfolio Blogger</title><meta name="description" content="Day 10 of my cloud security journey - Defend Reports for Day 7 - `lambda_privesc`"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="32x32"/><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&amp;family=Fira+Code:wght@400;700&amp;family=Orbitron:wght@400;700&amp;display=swap" rel="stylesheet"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="font-body antialiased min-h-screen bg-background text-foreground"><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("class","theme","system",null,["light","dark"],null,true,true)</script><div class="relative flex min-h-dvh flex-col"><header class="sticky top-0 z-50 w-full border-b border-border/40 bg-background/80 backdrop-blur-md supports-[backdrop-filter]:bg-background/60"><div class="w-full px-4 md:px-8 flex h-16 items-center justify-between"><a class="flex items-center gap-2" href="/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cloud-lightning h-6 w-6 text-primary"><path d="M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973"></path><path d="m13 12-3 5h4l-3 5"></path></svg><span class="font-cyber text-xl font-bold text-primary">x0vrpp</span></a><div class="flex items-center gap-6"><nav class="hidden md:flex items-center gap-6"><a class="transition-all relative text-lg md:text-sm px-2 py-1 rounded-md hover:text-primary hover:bg-primary/10 hover:shadow-[0_0_10px_rgba(var(--primary),0.5)] text-muted-foreground" href="/">About Me</a><a class="transition-all relative text-lg md:text-sm px-2 py-1 rounded-md hover:text-primary hover:bg-primary/10 hover:shadow-[0_0_10px_rgba(var(--primary),0.5)] text-muted-foreground" href="/certifications">Certifications</a><a class="transition-all relative text-lg md:text-sm px-2 py-1 rounded-md hover:text-primary hover:bg-primary/10 hover:shadow-[0_0_10px_rgba(var(--primary),0.5)] text-muted-foreground" href="/projects">Projects</a><a class="transition-all relative text-lg md:text-sm px-2 py-1 rounded-md hover:text-primary hover:bg-primary/10 hover:shadow-[0_0_10px_rgba(var(--primary),0.5)] text-primary font-bold shadow-[0_0_15px_rgba(var(--primary),0.6)]" href="/blog">Blog<span class="absolute -bottom-1 left-0 w-full h-[2px] bg-primary shadow-[0_0_10px_var(--primary)] hidden md:block animate-pulse"></span></a></nav><div class="hidden md:block"><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground h-9 w-9 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg><span class="sr-only">Toggle theme</span></button></div><div class="flex items-center md:hidden gap-4"><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground h-9 w-9 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg><span class="sr-only">Toggle theme</span></button><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground h-10 w-10" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-_R_n5lb_" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu h-6 w-6"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg><span class="sr-only">Open Menu</span></button></div></div></div></header><main class="flex-1 container flex flex-col py-4 md:py-8"><article class="max-w-4xl mx-auto px-4 py-8"><header class="mb-8 text-center"><h1 class="font-headline text-3xl md:text-5xl font-bold text-primary mb-3">100 Days of Cloud Security - Day 10: Defend Reports for Day 7 - `lambda_privesc`</h1><div class="text-muted-foreground text-sm md:text-base"><span>By <!-- -->Venkata Pathuri<!-- --> on </span><time dateTime="2025-11-19">November 19, 2025</time></div></header><div data-orientation="horizontal" role="none" class="shrink-0 bg-border h-[1px] w-full my-8"></div><div class="prose prose-lg dark:prose-invert max-w-none prose-headings:text-primary prose-a:text-primary"><h1>Day 10: Defend Reports for Day 7 - <code>lambda_privesc</code></h1>
<h2>Overview</h2>
<p>Welcome back to our 100-day cloud security journey! Today, we will delve deeper into defending against potential privilege escalation vulnerabilities, particularly focusing on the <code>lambda_privesc</code> scenario we encountered on Day 7. Building on our previous discussions around AWS IAM policies and roles, we'll explore critical security practices that will help you safeguard your cloud environment.</p>
<h2>Learning Objectives</h2>
<p>By the end of todayâ€™s lesson, you will master the principles of cross-service confused deputy prevention and understand the importance of crafting precise IAM policies to avoid overly permissive role assumptions. You will learn practical strategies to mitigate risks associated with <code>iam:PassRole</code> and <code>sts:AssumeRole</code>, ensuring a more secure AWS environment.</p>
<h2>Deep Dive</h2>
<h3>Cross-Service Confused Deputy Prevention</h3>
<p>The concept of confused deputy arises when one AWS service inadvertently uses another serviceâ€™s permissions, leading to unauthorized actions. For instance, imagine a Lambda function that has permissions to access an S3 bucket. If this Lambda function is exploited, an attacker could potentially manipulate it to perform actions on behalf of the S3 service that it shouldn't be allowed to execute.</p>
<p>To mitigate this, you can implement the <code>AWS:SourceArn</code> and <code>AWS:SourceAccount</code> condition keys in your IAM policies. These keys act as additional verification layers, ensuring that only trusted sources are allowed to invoke specific actions. For example, you could restrict access to an S3 bucket by specifying the ARN of the Lambda function that should interact with it, thus preventing any unauthorized service from making calls to the bucket.</p>
<p><img src="../img/day10-1.png" alt="Cross-Service Confused Deputy Prevention"></p>
<h3>No Custom Policy Permissive Role Assumption</h3>
<p>Next, letâ€™s address the risk of overly permissive role assumptions. If your IAM policies allow the use of wildcards in <code>sts:AssumeRole</code>, an attacker could escalate their privileges and gain access to sensitive resources. For instance, a poorly configured policy could allow any user to assume roles that should be strictly controlled.</p>
<p>To prevent this, always specify exact Role ARNs in your policies instead of using wildcards. Additionally, enforce resource-based restrictions to limit which entities can assume roles and under what conditions. This practice not only enhances security but also promotes a principle of least privilege.</p>
<p><img src="../img/day10-2.png" alt="IAM Policy Example">
<img src="../img/day10-3.png" alt="Role Assumption Example"></p>
<h3><code>iam:PassRole</code> as a Critical Privilege Escalation Vector</h3>
<p>One of the most critical permissions to monitor is <code>iam:PassRole</code>. This permission allows a user to pass a role to an AWS service, which can inadvertently grant that service elevated privileges. For example, if a user with <code>iam:PassRole</code> permission passes a role that has broader access than intended, it can lead to serious security vulnerabilities.</p>
<p>To protect against this, you should implement stringent policies that restrict which roles can be passed and by whom. For instance, if you have a user who can create EC2 instances, ensure they can only pass roles that are specifically designed for their use case, preventing them from gaining access to sensitive data or services inadvertently.</p>
<p><img src="../img/day10-4.png" alt="iam:PassRole Visual"></p>
<h2>Hands-On Practice</h2>
<p>To put these concepts into action, try the following:</p>
<ol>
<li>
<p><strong>Create an IAM Policy</strong>: Write an IAM policy that includes conditions using <code>AWS:SourceArn</code> and <code>AWS:SourceAccount</code>.</p>
<ul>
<li>Use the AWS Management Console or AWS CLI to create the policy.</li>
<li>Ensure that you specify exact Role ARNs without wildcards.</li>
</ul>
</li>
<li>
<p><strong>Test <code>iam:PassRole</code> Restrictions</strong>:</p>
<ul>
<li>Create two roles: one with limited permissions and another with broader permissions.</li>
<li>Assign the <code>iam:PassRole</code> permission to a user and attempt to pass both roles to an EC2 instance. Observe the behavior based on your policy definitions.</li>
</ul>
</li>
<li>
<p><strong>Verify Success</strong>:</p>
<ul>
<li>Check CloudTrail logs to see if the role assumptions were executed as intended.</li>
<li>Ensure that only the permitted role was passed and unauthorized actions were logged.</li>
</ul>
</li>
</ol>
<h3>Common Troubleshooting Tips</h3>
<ul>
<li>If policies are not behaving as expected, double-check the syntax and ensure that the conditions are correctly implemented.</li>
<li>Use the AWS Policy Simulator to test your IAM policies before applying them in a production environment.</li>
</ul>
<h2>Key Takeaways</h2>
<p>Today, we explored the importance of securing your AWS environment against privilege escalation through careful IAM policy design. By implementing specific conditions and avoiding wildcards in role assumptions, you can significantly reduce the risk of unauthorized access. We also highlighted the critical nature of <code>iam:PassRole</code> and how it can be a double-edged sword if not managed correctly.</p>
<h2>Real-World Applications</h2>
<p>These concepts are not just theoretical; they have real-world implications for organizations leveraging AWS. For instance, a financial services company recently faced a security breach due to a misconfigured IAM policy allowing excessive permissions. By applying the learning from today, they could have restricted access effectively and prevented unauthorized data access, thereby safeguarding sensitive customer information.</p>
<hr>
<p><strong>Journey Progress:</strong> 10/100 Days Complete ðŸš€</p>
</div></article><!--$--><!--/$--></main><footer class="border-t"><div class="container flex flex-col items-center justify-center gap-4 py-8 md:h-24 md:flex-row"><div class="flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cloud-lightning h-6 w-6 text-primary"><path d="M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973"></path><path d="m13 12-3 5h4l-3 5"></path></svg><p class="text-center text-sm leading-loose text-muted-foreground md:text-left">Â© <!-- -->2025<!-- --> Venkata Pathuri. All Rights Reserved.</p></div></div></footer></div><div role="region" aria-label="Notifications (F8)" tabindex="-1" style="pointer-events:none"><ol tabindex="-1" class="fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]"></ol></div><script src="/_next/static/chunks/webpack-ca8ebae7f954b22a.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[1458,[\"909\",\"static/chunks/909-740805674b8356ef.js\",\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"451\",\"static/chunks/451-c2def8cce98c3140.js\",\"177\",\"static/chunks/app/layout-98c332aef2240fe1.js\"],\"ThemeProvider\"]\n3:I[6970,[\"909\",\"static/chunks/909-740805674b8356ef.js\",\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"451\",\"static/chunks/451-c2def8cce98c3140.js\",\"177\",\"static/chunks/app/layout-98c332aef2240fe1.js\"],\"default\"]\n4:I[9766,[],\"\"]\n5:I[8924,[],\"\"]\n6:I[704,[\"909\",\"static/chunks/909-740805674b8356ef.js\",\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"451\",\"static/chunks/451-c2def8cce98c3140.js\",\"177\",\"static/chunks/app/layout-98c332aef2240fe1.js\"],\"Toaster\"]\n8:I[4431,[],\"OutletBoundary\"]\na:I[5278,[],\"AsyncMetadataOutlet\"]\nc:I[4431,[],\"ViewportBoundary\"]\ne:I[4431,[],\"MetadataBoundary\"]\nf:\"$Sreact.suspense\"\n11:I[7150,[],\"\"]\n:HL[\"/_next/static/css/440a8f778eae53e9.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"T3D1rtAHkxDRBIUJfY-F3\",\"p\":\"\",\"c\":[\"\",\"blog\",\"100-days-of-cloud-security-day-10\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"100-days-of-cloud-security-day-10\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/440a8f778eae53e9.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.googleapis.com\"}],[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.gstatic.com\",\"crossOrigin\":\"\"}],[\"$\",\"link\",null,{\"href\":\"https://fonts.googleapis.com/css2?family=Inter:wght@400;700\u0026family=Fira+Code:wght@400;700\u0026family=Orbitron:wght@400;700\u0026display=swap\",\"rel\":\"stylesheet\"}]]}],[\"$\",\"body\",null,{\"className\":\"font-body antialiased min-h-screen bg-background text-foreground\",\"children\":[\"$\",\"$L2\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[[\"$\",\"div\",null,{\"className\":\"relative flex min-h-dvh flex-col\",\"children\":[[\"$\",\"$L3\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex-1 container flex flex-col py-4 md:py-8\",\"children\":[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"footer\",null,{\"className\":\"border-t\",\"children\":[\"$\",\"div\",null,{\"className\":\"container flex flex-col items-center justify-center gap-4 py-8 md:h-24 md:flex-row\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-cloud-lightning h-6 w-6 text-primary\",\"children\":[[\"$\",\"path\",\"1cez44\",{\"d\":\"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973\"}],[\"$\",\"path\",\"1t22er\",{\"d\":\"m13 12-3 5h4l-3 5\"}],\"$undefined\"]}],[\"$\",\"p\",null,{\"className\":\"text-center text-sm leading-loose text-muted-foreground md:text-left\",\"children\":[\"Â© \",2025,\" Venkata Pathuri. All Rights Reserved.\"]}]]}]}]}]]}],[\"$\",\"$L6\",null,{}]]}]}]]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"100-days-of-cloud-security-day-10\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L7\",null,[\"$\",\"$L8\",null,{\"children\":[\"$L9\",[\"$\",\"$La\",null,{\"promise\":\"$@b\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],null],[\"$\",\"$Le\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$f\",null,{\"fallback\":null,\"children\":\"$L10\"}]}]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$11\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"12:I[8474,[\"909\",\"static/chunks/909-740805674b8356ef.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-586f9b997c6ba5d5.js\"],\"Separator\"]\n13:T1754,"])</script><script>self.__next_f.push([1,"\u003ch1\u003eDay 10: Defend Reports for Day 7 - \u003ccode\u003elambda_privesc\u003c/code\u003e\u003c/h1\u003e\n\u003ch2\u003eOverview\u003c/h2\u003e\n\u003cp\u003eWelcome back to our 100-day cloud security journey! Today, we will delve deeper into defending against potential privilege escalation vulnerabilities, particularly focusing on the \u003ccode\u003elambda_privesc\u003c/code\u003e scenario we encountered on Day 7. Building on our previous discussions around AWS IAM policies and roles, we'll explore critical security practices that will help you safeguard your cloud environment.\u003c/p\u003e\n\u003ch2\u003eLearning Objectives\u003c/h2\u003e\n\u003cp\u003eBy the end of todayâ€™s lesson, you will master the principles of cross-service confused deputy prevention and understand the importance of crafting precise IAM policies to avoid overly permissive role assumptions. You will learn practical strategies to mitigate risks associated with \u003ccode\u003eiam:PassRole\u003c/code\u003e and \u003ccode\u003ests:AssumeRole\u003c/code\u003e, ensuring a more secure AWS environment.\u003c/p\u003e\n\u003ch2\u003eDeep Dive\u003c/h2\u003e\n\u003ch3\u003eCross-Service Confused Deputy Prevention\u003c/h3\u003e\n\u003cp\u003eThe concept of confused deputy arises when one AWS service inadvertently uses another serviceâ€™s permissions, leading to unauthorized actions. For instance, imagine a Lambda function that has permissions to access an S3 bucket. If this Lambda function is exploited, an attacker could potentially manipulate it to perform actions on behalf of the S3 service that it shouldn't be allowed to execute.\u003c/p\u003e\n\u003cp\u003eTo mitigate this, you can implement the \u003ccode\u003eAWS:SourceArn\u003c/code\u003e and \u003ccode\u003eAWS:SourceAccount\u003c/code\u003e condition keys in your IAM policies. These keys act as additional verification layers, ensuring that only trusted sources are allowed to invoke specific actions. For example, you could restrict access to an S3 bucket by specifying the ARN of the Lambda function that should interact with it, thus preventing any unauthorized service from making calls to the bucket.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"../img/day10-1.png\" alt=\"Cross-Service Confused Deputy Prevention\"\u003e\u003c/p\u003e\n\u003ch3\u003eNo Custom Policy Permissive Role Assumption\u003c/h3\u003e\n\u003cp\u003eNext, letâ€™s address the risk of overly permissive role assumptions. If your IAM policies allow the use of wildcards in \u003ccode\u003ests:AssumeRole\u003c/code\u003e, an attacker could escalate their privileges and gain access to sensitive resources. For instance, a poorly configured policy could allow any user to assume roles that should be strictly controlled.\u003c/p\u003e\n\u003cp\u003eTo prevent this, always specify exact Role ARNs in your policies instead of using wildcards. Additionally, enforce resource-based restrictions to limit which entities can assume roles and under what conditions. This practice not only enhances security but also promotes a principle of least privilege.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"../img/day10-2.png\" alt=\"IAM Policy Example\"\u003e\n\u003cimg src=\"../img/day10-3.png\" alt=\"Role Assumption Example\"\u003e\u003c/p\u003e\n\u003ch3\u003e\u003ccode\u003eiam:PassRole\u003c/code\u003e as a Critical Privilege Escalation Vector\u003c/h3\u003e\n\u003cp\u003eOne of the most critical permissions to monitor is \u003ccode\u003eiam:PassRole\u003c/code\u003e. This permission allows a user to pass a role to an AWS service, which can inadvertently grant that service elevated privileges. For example, if a user with \u003ccode\u003eiam:PassRole\u003c/code\u003e permission passes a role that has broader access than intended, it can lead to serious security vulnerabilities.\u003c/p\u003e\n\u003cp\u003eTo protect against this, you should implement stringent policies that restrict which roles can be passed and by whom. For instance, if you have a user who can create EC2 instances, ensure they can only pass roles that are specifically designed for their use case, preventing them from gaining access to sensitive data or services inadvertently.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"../img/day10-4.png\" alt=\"iam:PassRole Visual\"\u003e\u003c/p\u003e\n\u003ch2\u003eHands-On Practice\u003c/h2\u003e\n\u003cp\u003eTo put these concepts into action, try the following:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eCreate an IAM Policy\u003c/strong\u003e: Write an IAM policy that includes conditions using \u003ccode\u003eAWS:SourceArn\u003c/code\u003e and \u003ccode\u003eAWS:SourceAccount\u003c/code\u003e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eUse the AWS Management Console or AWS CLI to create the policy.\u003c/li\u003e\n\u003cli\u003eEnsure that you specify exact Role ARNs without wildcards.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eTest \u003ccode\u003eiam:PassRole\u003c/code\u003e Restrictions\u003c/strong\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCreate two roles: one with limited permissions and another with broader permissions.\u003c/li\u003e\n\u003cli\u003eAssign the \u003ccode\u003eiam:PassRole\u003c/code\u003e permission to a user and attempt to pass both roles to an EC2 instance. Observe the behavior based on your policy definitions.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eVerify Success\u003c/strong\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCheck CloudTrail logs to see if the role assumptions were executed as intended.\u003c/li\u003e\n\u003cli\u003eEnsure that only the permitted role was passed and unauthorized actions were logged.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003eCommon Troubleshooting Tips\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eIf policies are not behaving as expected, double-check the syntax and ensure that the conditions are correctly implemented.\u003c/li\u003e\n\u003cli\u003eUse the AWS Policy Simulator to test your IAM policies before applying them in a production environment.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eKey Takeaways\u003c/h2\u003e\n\u003cp\u003eToday, we explored the importance of securing your AWS environment against privilege escalation through careful IAM policy design. By implementing specific conditions and avoiding wildcards in role assumptions, you can significantly reduce the risk of unauthorized access. We also highlighted the critical nature of \u003ccode\u003eiam:PassRole\u003c/code\u003e and how it can be a double-edged sword if not managed correctly.\u003c/p\u003e\n\u003ch2\u003eReal-World Applications\u003c/h2\u003e\n\u003cp\u003eThese concepts are not just theoretical; they have real-world implications for organizations leveraging AWS. For instance, a financial services company recently faced a security breach due to a misconfigured IAM policy allowing excessive permissions. By applying the learning from today, they could have restricted access effectively and prevented unauthorized data access, thereby safeguarding sensitive customer information.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cstrong\u003eJourney Progress:\u003c/strong\u003e 10/100 Days Complete ðŸš€\u003c/p\u003e\n"])</script><script>self.__next_f.push([1,"7:[\"$\",\"article\",null,{\"className\":\"max-w-4xl mx-auto px-4 py-8\",\"children\":[[\"$\",\"header\",null,{\"className\":\"mb-8 text-center\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"font-headline text-3xl md:text-5xl font-bold text-primary mb-3\",\"children\":\"100 Days of Cloud Security - Day 10: Defend Reports for Day 7 - `lambda_privesc`\"}],[\"$\",\"div\",null,{\"className\":\"text-muted-foreground text-sm md:text-base\",\"children\":[[\"$\",\"span\",null,{\"children\":[\"By \",\"Venkata Pathuri\",\" on \"]}],[\"$\",\"time\",null,{\"dateTime\":\"2025-11-19\",\"children\":\"November 19, 2025\"}]]}]]}],[\"$\",\"$L12\",null,{\"className\":\"my-8\"}],[\"$\",\"div\",null,{\"className\":\"prose prose-lg dark:prose-invert max-w-none prose-headings:text-primary prose-a:text-primary\",\"dangerouslySetInnerHTML\":{\"__html\":\"$13\"}}]]}]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n9:null\n"])</script><script>self.__next_f.push([1,"14:I[622,[],\"IconMark\"]\nb:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"100 Days of Cloud Security - Day 10: Defend Reports for Day 7 - `lambda_privesc` | Gitfolio Blogger\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Day 10 of my cloud security journey - Defend Reports for Day 7 - `lambda_privesc`\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"32x32\"}],[\"$\",\"$L14\",\"3\",{}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"10:\"$b:metadata\"\n"])</script></body></html>