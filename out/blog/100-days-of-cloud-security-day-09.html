<!DOCTYPE html><!--T3D1rtAHkxDRBIUJfY_F3--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/440a8f778eae53e9.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-ca8ebae7f954b22a.js"/><script src="/_next/static/chunks/4bd1b696-21f374d1156f834a.js" async=""></script><script src="/_next/static/chunks/255-87b65d3beb72be65.js" async=""></script><script src="/_next/static/chunks/main-app-105e7bfa05751db9.js" async=""></script><script src="/_next/static/chunks/909-740805674b8356ef.js" async=""></script><script src="/_next/static/chunks/619-ba102abea3e3d0e4.js" async=""></script><script src="/_next/static/chunks/451-c2def8cce98c3140.js" async=""></script><script src="/_next/static/chunks/app/layout-98c332aef2240fe1.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-586f9b997c6ba5d5.js" async=""></script><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""/><title>100 Days of Cloud Security - Day 9: AWS Lambda Privilege Escalation - Penetration Test Report - Claude Code | Gitfolio Blogger</title><meta name="description" content="Day 9 of my cloud security journey - AWS Lambda Privilege Escalation - Penetration Test Report - Claude Code"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="32x32"/><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&amp;family=Fira+Code:wght@400;700&amp;family=Orbitron:wght@400;700&amp;display=swap" rel="stylesheet"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="font-body antialiased min-h-screen bg-background text-foreground"><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("class","theme","system",null,["light","dark"],null,true,true)</script><div class="relative flex min-h-dvh flex-col"><header class="sticky top-0 z-50 w-full border-b border-border/40 bg-background/80 backdrop-blur-md supports-[backdrop-filter]:bg-background/60"><div class="w-full px-4 md:px-8 flex h-16 items-center justify-between"><a class="flex items-center gap-2" href="/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cloud-lightning h-6 w-6 text-primary"><path d="M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973"></path><path d="m13 12-3 5h4l-3 5"></path></svg><span class="font-cyber text-xl font-bold text-primary">x0vrpp</span></a><div class="flex items-center gap-6"><nav class="hidden md:flex items-center gap-6"><a class="transition-all relative text-lg md:text-sm px-2 py-1 rounded-md hover:text-primary hover:bg-primary/10 hover:shadow-[0_0_10px_rgba(var(--primary),0.5)] text-muted-foreground" href="/">About Me</a><a class="transition-all relative text-lg md:text-sm px-2 py-1 rounded-md hover:text-primary hover:bg-primary/10 hover:shadow-[0_0_10px_rgba(var(--primary),0.5)] text-muted-foreground" href="/certifications">Certifications</a><a class="transition-all relative text-lg md:text-sm px-2 py-1 rounded-md hover:text-primary hover:bg-primary/10 hover:shadow-[0_0_10px_rgba(var(--primary),0.5)] text-muted-foreground" href="/projects">Projects</a><a class="transition-all relative text-lg md:text-sm px-2 py-1 rounded-md hover:text-primary hover:bg-primary/10 hover:shadow-[0_0_10px_rgba(var(--primary),0.5)] text-primary font-bold shadow-[0_0_15px_rgba(var(--primary),0.6)]" href="/blog">Blog<span class="absolute -bottom-1 left-0 w-full h-[2px] bg-primary shadow-[0_0_10px_var(--primary)] hidden md:block animate-pulse"></span></a></nav><div class="hidden md:block"><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground h-9 w-9 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg><span class="sr-only">Toggle theme</span></button></div><div class="flex items-center md:hidden gap-4"><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground h-9 w-9 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg><span class="sr-only">Toggle theme</span></button><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground h-10 w-10" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-_R_n5lb_" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu h-6 w-6"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg><span class="sr-only">Open Menu</span></button></div></div></div></header><main class="flex-1 container flex flex-col py-4 md:py-8"><article class="max-w-4xl mx-auto px-4 py-8"><header class="mb-8 text-center"><h1 class="font-headline text-3xl md:text-5xl font-bold text-primary mb-3">100 Days of Cloud Security - Day 9: AWS Lambda Privilege Escalation - Penetration Test Report - Claude Code</h1><div class="text-muted-foreground text-sm md:text-base"><span>By <!-- -->Venkata Pathuri<!-- --> on </span><time dateTime="2025-11-18">November 18, 2025</time></div></header><div data-orientation="horizontal" role="none" class="shrink-0 bg-border h-[1px] w-full my-8"></div><div class="prose prose-lg dark:prose-invert max-w-none prose-headings:text-primary prose-a:text-primary"><h1>Day 9: AWS Lambda Privilege Escalation - Penetration Test Report - Claude Code</h1>
<h2>Overview</h2>
<p>In our cloud security journey, we now delve into a critical vulnerability that can lead to severe consequences if left unchecked: AWS Lambda privilege escalation. Building on our previous discussions around identity and access management (IAM) and the importance of least privilege, today we will explore a real-world penetration test report that highlights the risks associated with poor IAM configurations. Understanding this vulnerability will not only enhance your security posture but will also prepare you to identify and mitigate similar issues in your environments.</p>
<h2>Learning Objectives</h2>
<p>By the end of this session, you will master the intricacies of AWS Lambda privilege escalation, including how attackers exploit IAM role assumptions and Lambda function manipulations. You will learn to analyze IAM policies critically, identify vulnerabilities, and understand the ramifications of excessive permissions. Moreover, this knowledge will empower you to implement best practices that fortify your AWS environment against these types of attacks.</p>
<h2>Deep Dive</h2>
<h3>Understanding the Vulnerability</h3>
<p>In today's report, we examined a scenario where an IAM user, <code>chris-cgide3k5k2fwj7</code>, was able to escalate privileges simply by manipulating overly permissive IAM policies. The user was granted the ability to assume roles without restriction, which is a significant security oversight. The report illustrates a step-by-step attack chain that allows an attacker to gain full access to AWS Lambda functions, potentially leading to complete account compromise.</p>
<h4>Key Findings from the Penetration Test</h4>
<ol>
<li>
<p><strong>Overly Permissive IAM Policies</strong>: The user had unrestricted permissions to assume any role in the account. This lack of constraints enabled attackers to list all roles and their permissions easily.</p>
</li>
<li>
<p><strong>Lambda Permissions</strong>: The target IAM role had full Lambda permissions, allowing the attacker to create, modify, and invoke Lambda functions. This included the ability to pass IAM roles to Lambda functions, which could lead to further privilege escalation or data exfiltration.</p>
</li>
<li>
<p><strong>Access Key Exposure</strong>: The active access key for the vulnerable user was found in plaintext, making it easy for an attacker to exploit it.</p>
</li>
</ol>
<h3>Real-World Example</h3>
<p>Imagine a scenario where a developer is given permissions to assume any IAM role in a production environment without any restrictions. Such an oversight could lead to attackers gaining access to sensitive data or systems, potentially resulting in significant financial and reputational damage. The report illustrates exactly how this could unfold, emphasizing the need for stringent IAM policies.</p>
<h3>Best Practices</h3>
<p>To prevent such vulnerabilities, consider the following best practices:</p>
<ul>
<li>
<p><strong>Implement Least Privilege</strong>: Limit permissions to only what is necessary for users to perform their roles. For example, instead of allowing <code>lambda:*</code>, specify actions like <code>lambda:InvokeFunction</code> or <code>lambda:GetFunction</code>.</p>
</li>
<li>
<p><strong>Use Conditions in IAM Policies</strong>: Leverage condition keys in IAM policies to restrict access based on factors like IP address or the presence of MFA.</p>
</li>
<li>
<p><strong>Regularly Rotate Access Keys</strong>: Ensure that AWS access keys are rotated regularly and stored securely. Avoid hard-coding them in source code or configuration files.</p>
</li>
<li>
<p><strong>Enable Monitoring and Alerts</strong>: Utilize AWS CloudTrail and CloudWatch to track API calls and set up alerts for unusual activities, such as unexpected role assumptions or Lambda function creations.</p>
</li>
</ul>
<h2>Hands-On Practice</h2>
<h3>Steps to Secure IAM Policies</h3>
<ol>
<li>
<p><strong>Review IAM Policies</strong>: Use the AWS Management Console or CLI to list IAM policies attached to users and roles. Look for overly permissive policies.</p>
<pre><code class="language-bash">aws iam list-policies --scope Local
</code></pre>
</li>
<li>
<p><strong>Restrict AssumeRole Permissions</strong>: Update IAM policies to limit which roles can be assumed by specifying the role ARN and using conditions.</p>
<pre><code class="language-json">{
  "Effect": "Allow",
  "Action": "sts:AssumeRole",
  "Resource": "arn:aws:iam::your-account-id:role/specific-role-name",
  "Condition": {
    "IpAddress": {
      "aws:SourceIp": ["10.0.0.0/8"]
    }
  }
}
</code></pre>
</li>
<li>
<p><strong>Enable CloudTrail</strong>: Make sure that CloudTrail is enabled to log all API calls made within your AWS account.</p>
<pre><code class="language-bash">aws cloudtrail create-trail --name MyTrail --s3-bucket-name mybucket
</code></pre>
</li>
</ol>
<h3>Verification</h3>
<p>After implementing the changes, verify that the policies are functioning as intended by testing the permissions with the IAM Policy Simulator. This tool helps ensure that your configurations are secure without inadvertently blocking necessary actions.</p>
<h2>Key Takeaways</h2>
<p>The critical lesson from today's exploration is the importance of rigorous IAM management and the need for continuous monitoring. The vulnerabilities discovered in the AWS Lambda environment serve as a stark reminder of how small oversights in permission management can lead to catastrophic consequences. By implementing best practices and regularly reviewing IAM policies, you can drastically reduce the attack surface in your cloud environments.</p>
<h2>Real-World Applications</h2>
<p>In production environments, understanding privilege escalation is essential for maintaining robust security. Organizations can apply the insights gained from this report to conduct thorough audits of their IAM configurations, ensuring that permissions are tightly controlled and monitored. By fostering a culture of security awareness and implementing preventive measures, businesses can safeguard their cloud resources against evolving threats.</p>
<hr>
<p><strong>Journey Progress:</strong> 9/100 Days Complete ðŸš€</p>
</div></article><!--$--><!--/$--></main><footer class="border-t"><div class="container flex flex-col items-center justify-center gap-4 py-8 md:h-24 md:flex-row"><div class="flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cloud-lightning h-6 w-6 text-primary"><path d="M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973"></path><path d="m13 12-3 5h4l-3 5"></path></svg><p class="text-center text-sm leading-loose text-muted-foreground md:text-left">Â© <!-- -->2025<!-- --> Venkata Pathuri. All Rights Reserved.</p></div></div></footer></div><div role="region" aria-label="Notifications (F8)" tabindex="-1" style="pointer-events:none"><ol tabindex="-1" class="fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]"></ol></div><script src="/_next/static/chunks/webpack-ca8ebae7f954b22a.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[1458,[\"909\",\"static/chunks/909-740805674b8356ef.js\",\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"451\",\"static/chunks/451-c2def8cce98c3140.js\",\"177\",\"static/chunks/app/layout-98c332aef2240fe1.js\"],\"ThemeProvider\"]\n3:I[6970,[\"909\",\"static/chunks/909-740805674b8356ef.js\",\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"451\",\"static/chunks/451-c2def8cce98c3140.js\",\"177\",\"static/chunks/app/layout-98c332aef2240fe1.js\"],\"default\"]\n4:I[9766,[],\"\"]\n5:I[8924,[],\"\"]\n6:I[704,[\"909\",\"static/chunks/909-740805674b8356ef.js\",\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"451\",\"static/chunks/451-c2def8cce98c3140.js\",\"177\",\"static/chunks/app/layout-98c332aef2240fe1.js\"],\"Toaster\"]\n8:I[4431,[],\"OutletBoundary\"]\na:I[5278,[],\"AsyncMetadataOutlet\"]\nc:I[4431,[],\"ViewportBoundary\"]\ne:I[4431,[],\"MetadataBoundary\"]\nf:\"$Sreact.suspense\"\n11:I[7150,[],\"\"]\n:HL[\"/_next/static/css/440a8f778eae53e9.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"T3D1rtAHkxDRBIUJfY-F3\",\"p\":\"\",\"c\":[\"\",\"blog\",\"100-days-of-cloud-security-day-09\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"100-days-of-cloud-security-day-09\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/440a8f778eae53e9.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.googleapis.com\"}],[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.gstatic.com\",\"crossOrigin\":\"\"}],[\"$\",\"link\",null,{\"href\":\"https://fonts.googleapis.com/css2?family=Inter:wght@400;700\u0026family=Fira+Code:wght@400;700\u0026family=Orbitron:wght@400;700\u0026display=swap\",\"rel\":\"stylesheet\"}]]}],[\"$\",\"body\",null,{\"className\":\"font-body antialiased min-h-screen bg-background text-foreground\",\"children\":[\"$\",\"$L2\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[[\"$\",\"div\",null,{\"className\":\"relative flex min-h-dvh flex-col\",\"children\":[[\"$\",\"$L3\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex-1 container flex flex-col py-4 md:py-8\",\"children\":[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"footer\",null,{\"className\":\"border-t\",\"children\":[\"$\",\"div\",null,{\"className\":\"container flex flex-col items-center justify-center gap-4 py-8 md:h-24 md:flex-row\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-cloud-lightning h-6 w-6 text-primary\",\"children\":[[\"$\",\"path\",\"1cez44\",{\"d\":\"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973\"}],[\"$\",\"path\",\"1t22er\",{\"d\":\"m13 12-3 5h4l-3 5\"}],\"$undefined\"]}],[\"$\",\"p\",null,{\"className\":\"text-center text-sm leading-loose text-muted-foreground md:text-left\",\"children\":[\"Â© \",2025,\" Venkata Pathuri. All Rights Reserved.\"]}]]}]}]}]]}],[\"$\",\"$L6\",null,{}]]}]}]]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"100-days-of-cloud-security-day-09\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L7\",null,[\"$\",\"$L8\",null,{\"children\":[\"$L9\",[\"$\",\"$La\",null,{\"promise\":\"$@b\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],null],[\"$\",\"$Le\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$f\",null,{\"fallback\":null,\"children\":\"$L10\"}]}]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$11\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"12:I[8474,[\"909\",\"static/chunks/909-740805674b8356ef.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-586f9b997c6ba5d5.js\"],\"Separator\"]\n13:T1882,"])</script><script>self.__next_f.push([1,"\u003ch1\u003eDay 9: AWS Lambda Privilege Escalation - Penetration Test Report - Claude Code\u003c/h1\u003e\n\u003ch2\u003eOverview\u003c/h2\u003e\n\u003cp\u003eIn our cloud security journey, we now delve into a critical vulnerability that can lead to severe consequences if left unchecked: AWS Lambda privilege escalation. Building on our previous discussions around identity and access management (IAM) and the importance of least privilege, today we will explore a real-world penetration test report that highlights the risks associated with poor IAM configurations. Understanding this vulnerability will not only enhance your security posture but will also prepare you to identify and mitigate similar issues in your environments.\u003c/p\u003e\n\u003ch2\u003eLearning Objectives\u003c/h2\u003e\n\u003cp\u003eBy the end of this session, you will master the intricacies of AWS Lambda privilege escalation, including how attackers exploit IAM role assumptions and Lambda function manipulations. You will learn to analyze IAM policies critically, identify vulnerabilities, and understand the ramifications of excessive permissions. Moreover, this knowledge will empower you to implement best practices that fortify your AWS environment against these types of attacks.\u003c/p\u003e\n\u003ch2\u003eDeep Dive\u003c/h2\u003e\n\u003ch3\u003eUnderstanding the Vulnerability\u003c/h3\u003e\n\u003cp\u003eIn today's report, we examined a scenario where an IAM user, \u003ccode\u003echris-cgide3k5k2fwj7\u003c/code\u003e, was able to escalate privileges simply by manipulating overly permissive IAM policies. The user was granted the ability to assume roles without restriction, which is a significant security oversight. The report illustrates a step-by-step attack chain that allows an attacker to gain full access to AWS Lambda functions, potentially leading to complete account compromise.\u003c/p\u003e\n\u003ch4\u003eKey Findings from the Penetration Test\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eOverly Permissive IAM Policies\u003c/strong\u003e: The user had unrestricted permissions to assume any role in the account. This lack of constraints enabled attackers to list all roles and their permissions easily.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eLambda Permissions\u003c/strong\u003e: The target IAM role had full Lambda permissions, allowing the attacker to create, modify, and invoke Lambda functions. This included the ability to pass IAM roles to Lambda functions, which could lead to further privilege escalation or data exfiltration.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eAccess Key Exposure\u003c/strong\u003e: The active access key for the vulnerable user was found in plaintext, making it easy for an attacker to exploit it.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003eReal-World Example\u003c/h3\u003e\n\u003cp\u003eImagine a scenario where a developer is given permissions to assume any IAM role in a production environment without any restrictions. Such an oversight could lead to attackers gaining access to sensitive data or systems, potentially resulting in significant financial and reputational damage. The report illustrates exactly how this could unfold, emphasizing the need for stringent IAM policies.\u003c/p\u003e\n\u003ch3\u003eBest Practices\u003c/h3\u003e\n\u003cp\u003eTo prevent such vulnerabilities, consider the following best practices:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eImplement Least Privilege\u003c/strong\u003e: Limit permissions to only what is necessary for users to perform their roles. For example, instead of allowing \u003ccode\u003elambda:*\u003c/code\u003e, specify actions like \u003ccode\u003elambda:InvokeFunction\u003c/code\u003e or \u003ccode\u003elambda:GetFunction\u003c/code\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eUse Conditions in IAM Policies\u003c/strong\u003e: Leverage condition keys in IAM policies to restrict access based on factors like IP address or the presence of MFA.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eRegularly Rotate Access Keys\u003c/strong\u003e: Ensure that AWS access keys are rotated regularly and stored securely. Avoid hard-coding them in source code or configuration files.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eEnable Monitoring and Alerts\u003c/strong\u003e: Utilize AWS CloudTrail and CloudWatch to track API calls and set up alerts for unusual activities, such as unexpected role assumptions or Lambda function creations.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eHands-On Practice\u003c/h2\u003e\n\u003ch3\u003eSteps to Secure IAM Policies\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eReview IAM Policies\u003c/strong\u003e: Use the AWS Management Console or CLI to list IAM policies attached to users and roles. Look for overly permissive policies.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003eaws iam list-policies --scope Local\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eRestrict AssumeRole Permissions\u003c/strong\u003e: Update IAM policies to limit which roles can be assumed by specifying the role ARN and using conditions.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-json\"\u003e{\n  \"Effect\": \"Allow\",\n  \"Action\": \"sts:AssumeRole\",\n  \"Resource\": \"arn:aws:iam::your-account-id:role/specific-role-name\",\n  \"Condition\": {\n    \"IpAddress\": {\n      \"aws:SourceIp\": [\"10.0.0.0/8\"]\n    }\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eEnable CloudTrail\u003c/strong\u003e: Make sure that CloudTrail is enabled to log all API calls made within your AWS account.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003eaws cloudtrail create-trail --name MyTrail --s3-bucket-name mybucket\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003eVerification\u003c/h3\u003e\n\u003cp\u003eAfter implementing the changes, verify that the policies are functioning as intended by testing the permissions with the IAM Policy Simulator. This tool helps ensure that your configurations are secure without inadvertently blocking necessary actions.\u003c/p\u003e\n\u003ch2\u003eKey Takeaways\u003c/h2\u003e\n\u003cp\u003eThe critical lesson from today's exploration is the importance of rigorous IAM management and the need for continuous monitoring. The vulnerabilities discovered in the AWS Lambda environment serve as a stark reminder of how small oversights in permission management can lead to catastrophic consequences. By implementing best practices and regularly reviewing IAM policies, you can drastically reduce the attack surface in your cloud environments.\u003c/p\u003e\n\u003ch2\u003eReal-World Applications\u003c/h2\u003e\n\u003cp\u003eIn production environments, understanding privilege escalation is essential for maintaining robust security. Organizations can apply the insights gained from this report to conduct thorough audits of their IAM configurations, ensuring that permissions are tightly controlled and monitored. By fostering a culture of security awareness and implementing preventive measures, businesses can safeguard their cloud resources against evolving threats.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cstrong\u003eJourney Progress:\u003c/strong\u003e 9/100 Days Complete ðŸš€\u003c/p\u003e\n"])</script><script>self.__next_f.push([1,"7:[\"$\",\"article\",null,{\"className\":\"max-w-4xl mx-auto px-4 py-8\",\"children\":[[\"$\",\"header\",null,{\"className\":\"mb-8 text-center\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"font-headline text-3xl md:text-5xl font-bold text-primary mb-3\",\"children\":\"100 Days of Cloud Security - Day 9: AWS Lambda Privilege Escalation - Penetration Test Report - Claude Code\"}],[\"$\",\"div\",null,{\"className\":\"text-muted-foreground text-sm md:text-base\",\"children\":[[\"$\",\"span\",null,{\"children\":[\"By \",\"Venkata Pathuri\",\" on \"]}],[\"$\",\"time\",null,{\"dateTime\":\"2025-11-18\",\"children\":\"November 18, 2025\"}]]}]]}],[\"$\",\"$L12\",null,{\"className\":\"my-8\"}],[\"$\",\"div\",null,{\"className\":\"prose prose-lg dark:prose-invert max-w-none prose-headings:text-primary prose-a:text-primary\",\"dangerouslySetInnerHTML\":{\"__html\":\"$13\"}}]]}]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n9:null\n"])</script><script>self.__next_f.push([1,"14:I[622,[],\"IconMark\"]\nb:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"100 Days of Cloud Security - Day 9: AWS Lambda Privilege Escalation - Penetration Test Report - Claude Code | Gitfolio Blogger\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Day 9 of my cloud security journey - AWS Lambda Privilege Escalation - Penetration Test Report - Claude Code\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"32x32\"}],[\"$\",\"$L14\",\"3\",{}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"10:\"$b:metadata\"\n"])</script></body></html>