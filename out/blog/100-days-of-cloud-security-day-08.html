<!DOCTYPE html><!--JMtuDo3EXuReSaRmaYdn1--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/646ef98856fbea42.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-ca8ebae7f954b22a.js"/><script src="/_next/static/chunks/4bd1b696-21f374d1156f834a.js" async=""></script><script src="/_next/static/chunks/255-87b65d3beb72be65.js" async=""></script><script src="/_next/static/chunks/main-app-105e7bfa05751db9.js" async=""></script><script src="/_next/static/chunks/619-ba102abea3e3d0e4.js" async=""></script><script src="/_next/static/chunks/909-740805674b8356ef.js" async=""></script><script src="/_next/static/chunks/451-c2def8cce98c3140.js" async=""></script><script src="/_next/static/chunks/app/layout-870cdc0898a1f2e6.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-586f9b997c6ba5d5.js" async=""></script><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""/><title>100 Days of Cloud Security - Day 8: Defend - `lambda_privesc` | Gitfolio Blogger</title><meta name="description" content="Day 8 of my cloud security journey - Defend - `lambda_privesc`"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="32x32"/><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&amp;family=Fira+Code:wght@400;700&amp;family=Orbitron:wght@400;700&amp;display=swap" rel="stylesheet"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="font-body antialiased min-h-screen bg-background text-foreground"><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("class","theme","system",null,["light","dark"],null,true,true)</script><div class="relative flex min-h-dvh flex-col"><header class="sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60"><div class="w-full px-4 md:px-8 flex h-16 items-center justify-between"><a class="flex items-center gap-2" href="/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cloud-lightning h-6 w-6 text-primary"><path d="M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973"></path><path d="m13 12-3 5h4l-3 5"></path></svg><span class="font-cyber text-xl font-bold text-primary">x0vrpp</span></a><div class="flex items-center gap-6"><nav class="hidden md:flex items-center gap-6"><a class="transition-colors relative text-lg md:text-sm hover:text-primary text-muted-foreground" href="/">About Me</a><a class="transition-colors relative text-lg md:text-sm hover:text-primary text-muted-foreground" href="/certifications">Certifications</a><a class="transition-colors relative text-lg md:text-sm hover:text-primary text-muted-foreground" href="/projects">Projects</a><a class="transition-colors relative text-lg md:text-sm hover:text-primary text-primary font-semibold" href="/blog">Blog<span class="absolute -bottom-2 left-1/2 -translate-x-1/2 w-2 h-2 rounded-full bg-primary hidden md:block"></span></a></nav><div class="hidden md:block"><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground h-9 w-9 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg><span class="sr-only">Toggle theme</span></button></div><div class="flex items-center md:hidden gap-4"><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground h-9 w-9 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg><span class="sr-only">Toggle theme</span></button><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground h-10 w-10" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-_R_n5lb_" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu h-6 w-6"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg><span class="sr-only">Open Menu</span></button></div></div></div></header><main class="flex-1 container py-10"><article class="max-w-4xl mx-auto px-4 py-8"><header class="mb-8 text-center"><h1 class="font-headline text-3xl md:text-5xl font-bold text-primary mb-3">100 Days of Cloud Security - Day 8: Defend - `lambda_privesc`</h1><div class="text-muted-foreground text-sm md:text-base"><span>By <!-- -->Venkata Pathuri<!-- --> on </span><time dateTime="2025-11-17">November 17, 2025</time></div></header><div data-orientation="horizontal" role="none" class="shrink-0 bg-border h-[1px] w-full my-8"></div><div class="prose prose-lg dark:prose-invert max-w-none prose-headings:text-primary prose-a:text-primary"><h1>Day 8: Defend - <code>lambda_privesc</code></h1>
<h2>Overview</h2>
<p>Welcome back to Day 8 of our cloud security journey! Today, we delve into the critical area of defending against privilege escalation vulnerabilities, specifically in AWS Lambda environments. Building on our previous discussions about identity and access management (IAM) from Day 7, we will explore how to implement the principle of least privilege effectively to secure your Lambda functions from potential exploitation.</p>
<h2>Learning Objectives</h2>
<p>By the end of this lesson, you will master the art of securely implementing the <code>lambda_privesc</code> scenario. You will learn to identify overly permissive IAM policies and remediate them to prevent privilege escalation. You will also gain insights into crafting IAM policies that align with the principle of least privilege, ensuring that users and roles have only the permissions essential to perform their tasks.</p>
<h2>Deep Dive</h2>
<p>In our analysis, we identified a significant vulnerability in the <code>cg-lambdaManager-policy-cgide3k5k2fwj7</code>, which allowed excessive permissions due to the inclusion of the <code>iam:PassRole</code> action with a wildcard resource (<code>"*"</code>). This configuration could enable an attacker to create a Lambda function with an elevated role, such as <code>AdministratorAccess</code>, leading to potentially catastrophic outcomes.</p>
<h3>Vulnerability Breakdown</h3>
<p>The original policy was structured as follows:</p>
<pre><code class="language-json">{
    "Statement": [
        {
            "Action": [
                "lambda:*",
                "iam:PassRole"
            ],
            "Effect": "Allow",
            "Resource": "*",
            "Sid": "lambdaManager"
        }
    ],
    "Version": "2012-10-17"
}
</code></pre>
<p>The glaring issue here is that it grants the ability to pass any IAM role, which is a common attack vector for privilege escalation in cloud environments.</p>
<h3>Remediation Steps</h3>
<p>To correct this security flaw, we modified the policy to restrict the <code>iam:PassRole</code> action to a designated role, thereby adhering to the principle of least privilege:</p>
<pre><code class="language-json">{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "LambdaActions",
            "Effect": "Allow",
            "Action": "lambda:*",
            "Resource": "*"
        },
        {
            "Sid": "RestrictPassRole",
            "Effect": "Allow",
            "Action": "iam:PassRole",
            "Resource": "arn:aws:iam::ACCOUNT_ID:role/SAFE_LAMBDA_EXECUTION_ROLE"
        }
    ]
}
</code></pre>
<p>This approach mitigates the risk of privilege escalation by ensuring that only the specified <code>SAFE_LAMBDA_EXECUTION_ROLE</code> can be passed, preventing any high-privilege roles from being assigned by users with the <code>lambdaManager</code> role.</p>
<h3>Visual Insights</h3>
<p>As you work through this scenario, you'll see graphical representations of permissions and alerts indicating when a policy is too permissive. These visuals are crucial for understanding the implications of your IAM configurations.</p>
<h3>Current Best Practices</h3>
<ul>
<li><strong>Restrict <code>iam:PassRole</code></strong>: Always limit the roles that can be passed to only those necessary for the Lambda function's operation.</li>
<li><strong>Regularly Audit IAM Policies</strong>: Conduct routine audits of IAM policies to ensure compliance with least privilege principles.</li>
<li><strong>Use Role-based Access Control (RBAC)</strong>: Implement RBAC to manage permissions more effectively and reduce complexity in IAM policies.</li>
</ul>
<h2>Hands-On Practice</h2>
<p>To apply what you've learned, follow these steps in your CloudGoat lab:</p>
<ol>
<li><strong>Access the IAM Policy</strong>: Navigate to the IAM section in the AWS Management Console and locate the <code>cg-lambdaManager-policy</code>.</li>
<li><strong>Modify the Policy</strong>: Edit the policy to restrict the <code>iam:PassRole</code> action as demonstrated above.</li>
<li><strong>Test the Policy</strong>: Attempt to create a Lambda function with an elevated role (e.g., one with <code>AdministratorAccess</code>). You should receive an error indicating insufficient permissions.</li>
<li><strong>Verify Changes</strong>: Ensure that your changes are saved and that the policy displays the new restrictions.</li>
</ol>
<h3>Troubleshooting Tips</h3>
<ul>
<li>If you encounter issues applying the modified policy, double-check the ARN for the <code>SAFE_LAMBDA_EXECUTION_ROLE</code> for accuracy.</li>
<li>Ensure that your IAM user has permission to modify policies; if not, consult your administrator.</li>
</ul>
<h2>Key Takeaways</h2>
<p>Today's lesson underscored the importance of implementing the principle of least privilege in cloud security. By identifying and remediating overly permissive IAM policies, we not only enhance security but also foster a culture of caution and responsibility in cloud resource management. As we progress, remember that vigilance and regular audits are your best defenses against privilege escalation attacks.</p>
<h2>Real-World Applications</h2>
<p>In production environments, the lessons learned today are invaluable. Organizations often face the challenge of managing numerous IAM roles and policies. By adhering to the principles discussed, they can significantly reduce their attack surface and protect sensitive resources from unauthorized access. Moreover, implementing these best practices creates a robust security posture that can withstand the evolving threat landscape in cloud environments.</p>
<hr>
<p><strong>Journey Progress:</strong> 8/100 Days Complete ðŸš€</p>
</div></article><!--$--><!--/$--></main><footer class="border-t"><div class="container flex flex-col items-center justify-center gap-4 py-8 md:h-24 md:flex-row"><div class="flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cloud-lightning h-6 w-6 text-primary"><path d="M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973"></path><path d="m13 12-3 5h4l-3 5"></path></svg><p class="text-center text-sm leading-loose text-muted-foreground md:text-left">Â© <!-- -->2025<!-- --> Venkata Pathuri. All Rights Reserved.</p></div></div></footer></div><div role="region" aria-label="Notifications (F8)" tabindex="-1" style="pointer-events:none"><ol tabindex="-1" class="fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]"></ol></div><script src="/_next/static/chunks/webpack-ca8ebae7f954b22a.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[1458,[\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"909\",\"static/chunks/909-740805674b8356ef.js\",\"451\",\"static/chunks/451-c2def8cce98c3140.js\",\"177\",\"static/chunks/app/layout-870cdc0898a1f2e6.js\"],\"ThemeProvider\"]\n3:I[6970,[\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"909\",\"static/chunks/909-740805674b8356ef.js\",\"451\",\"static/chunks/451-c2def8cce98c3140.js\",\"177\",\"static/chunks/app/layout-870cdc0898a1f2e6.js\"],\"default\"]\n4:I[9766,[],\"\"]\n5:I[8924,[],\"\"]\n6:I[704,[\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"909\",\"static/chunks/909-740805674b8356ef.js\",\"451\",\"static/chunks/451-c2def8cce98c3140.js\",\"177\",\"static/chunks/app/layout-870cdc0898a1f2e6.js\"],\"Toaster\"]\n8:I[4431,[],\"OutletBoundary\"]\na:I[5278,[],\"AsyncMetadataOutlet\"]\nc:I[4431,[],\"ViewportBoundary\"]\ne:I[4431,[],\"MetadataBoundary\"]\nf:\"$Sreact.suspense\"\n11:I[7150,[],\"\"]\n:HL[\"/_next/static/css/646ef98856fbea42.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"JMtuDo3EXuReSaRmaYdn1\",\"p\":\"\",\"c\":[\"\",\"blog\",\"100-days-of-cloud-security-day-08\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"100-days-of-cloud-security-day-08\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/646ef98856fbea42.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.googleapis.com\"}],[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.gstatic.com\",\"crossOrigin\":\"\"}],[\"$\",\"link\",null,{\"href\":\"https://fonts.googleapis.com/css2?family=Inter:wght@400;700\u0026family=Fira+Code:wght@400;700\u0026family=Orbitron:wght@400;700\u0026display=swap\",\"rel\":\"stylesheet\"}]]}],[\"$\",\"body\",null,{\"className\":\"font-body antialiased min-h-screen bg-background text-foreground\",\"children\":[\"$\",\"$L2\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[[\"$\",\"div\",null,{\"className\":\"relative flex min-h-dvh flex-col\",\"children\":[[\"$\",\"$L3\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex-1 container py-10\",\"children\":[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"footer\",null,{\"className\":\"border-t\",\"children\":[\"$\",\"div\",null,{\"className\":\"container flex flex-col items-center justify-center gap-4 py-8 md:h-24 md:flex-row\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-cloud-lightning h-6 w-6 text-primary\",\"children\":[[\"$\",\"path\",\"1cez44\",{\"d\":\"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973\"}],[\"$\",\"path\",\"1t22er\",{\"d\":\"m13 12-3 5h4l-3 5\"}],\"$undefined\"]}],[\"$\",\"p\",null,{\"className\":\"text-center text-sm leading-loose text-muted-foreground md:text-left\",\"children\":[\"Â© \",2025,\" Venkata Pathuri. All Rights Reserved.\"]}]]}]}]}]]}],[\"$\",\"$L6\",null,{}]]}]}]]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"100-days-of-cloud-security-day-08\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L7\",null,[\"$\",\"$L8\",null,{\"children\":[\"$L9\",[\"$\",\"$La\",null,{\"promise\":\"$@b\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],null],[\"$\",\"$Le\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$f\",null,{\"fallback\":null,\"children\":\"$L10\"}]}]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$11\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"12:I[8474,[\"909\",\"static/chunks/909-740805674b8356ef.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-586f9b997c6ba5d5.js\"],\"Separator\"]\n13:T1686,"])</script><script>self.__next_f.push([1,"\u003ch1\u003eDay 8: Defend - \u003ccode\u003elambda_privesc\u003c/code\u003e\u003c/h1\u003e\n\u003ch2\u003eOverview\u003c/h2\u003e\n\u003cp\u003eWelcome back to Day 8 of our cloud security journey! Today, we delve into the critical area of defending against privilege escalation vulnerabilities, specifically in AWS Lambda environments. Building on our previous discussions about identity and access management (IAM) from Day 7, we will explore how to implement the principle of least privilege effectively to secure your Lambda functions from potential exploitation.\u003c/p\u003e\n\u003ch2\u003eLearning Objectives\u003c/h2\u003e\n\u003cp\u003eBy the end of this lesson, you will master the art of securely implementing the \u003ccode\u003elambda_privesc\u003c/code\u003e scenario. You will learn to identify overly permissive IAM policies and remediate them to prevent privilege escalation. You will also gain insights into crafting IAM policies that align with the principle of least privilege, ensuring that users and roles have only the permissions essential to perform their tasks.\u003c/p\u003e\n\u003ch2\u003eDeep Dive\u003c/h2\u003e\n\u003cp\u003eIn our analysis, we identified a significant vulnerability in the \u003ccode\u003ecg-lambdaManager-policy-cgide3k5k2fwj7\u003c/code\u003e, which allowed excessive permissions due to the inclusion of the \u003ccode\u003eiam:PassRole\u003c/code\u003e action with a wildcard resource (\u003ccode\u003e\"*\"\u003c/code\u003e). This configuration could enable an attacker to create a Lambda function with an elevated role, such as \u003ccode\u003eAdministratorAccess\u003c/code\u003e, leading to potentially catastrophic outcomes.\u003c/p\u003e\n\u003ch3\u003eVulnerability Breakdown\u003c/h3\u003e\n\u003cp\u003eThe original policy was structured as follows:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-json\"\u003e{\n    \"Statement\": [\n        {\n            \"Action\": [\n                \"lambda:*\",\n                \"iam:PassRole\"\n            ],\n            \"Effect\": \"Allow\",\n            \"Resource\": \"*\",\n            \"Sid\": \"lambdaManager\"\n        }\n    ],\n    \"Version\": \"2012-10-17\"\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe glaring issue here is that it grants the ability to pass any IAM role, which is a common attack vector for privilege escalation in cloud environments.\u003c/p\u003e\n\u003ch3\u003eRemediation Steps\u003c/h3\u003e\n\u003cp\u003eTo correct this security flaw, we modified the policy to restrict the \u003ccode\u003eiam:PassRole\u003c/code\u003e action to a designated role, thereby adhering to the principle of least privilege:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-json\"\u003e{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"LambdaActions\",\n            \"Effect\": \"Allow\",\n            \"Action\": \"lambda:*\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"RestrictPassRole\",\n            \"Effect\": \"Allow\",\n            \"Action\": \"iam:PassRole\",\n            \"Resource\": \"arn:aws:iam::ACCOUNT_ID:role/SAFE_LAMBDA_EXECUTION_ROLE\"\n        }\n    ]\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis approach mitigates the risk of privilege escalation by ensuring that only the specified \u003ccode\u003eSAFE_LAMBDA_EXECUTION_ROLE\u003c/code\u003e can be passed, preventing any high-privilege roles from being assigned by users with the \u003ccode\u003elambdaManager\u003c/code\u003e role.\u003c/p\u003e\n\u003ch3\u003eVisual Insights\u003c/h3\u003e\n\u003cp\u003eAs you work through this scenario, you'll see graphical representations of permissions and alerts indicating when a policy is too permissive. These visuals are crucial for understanding the implications of your IAM configurations.\u003c/p\u003e\n\u003ch3\u003eCurrent Best Practices\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eRestrict \u003ccode\u003eiam:PassRole\u003c/code\u003e\u003c/strong\u003e: Always limit the roles that can be passed to only those necessary for the Lambda function's operation.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRegularly Audit IAM Policies\u003c/strong\u003e: Conduct routine audits of IAM policies to ensure compliance with least privilege principles.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eUse Role-based Access Control (RBAC)\u003c/strong\u003e: Implement RBAC to manage permissions more effectively and reduce complexity in IAM policies.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eHands-On Practice\u003c/h2\u003e\n\u003cp\u003eTo apply what you've learned, follow these steps in your CloudGoat lab:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eAccess the IAM Policy\u003c/strong\u003e: Navigate to the IAM section in the AWS Management Console and locate the \u003ccode\u003ecg-lambdaManager-policy\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eModify the Policy\u003c/strong\u003e: Edit the policy to restrict the \u003ccode\u003eiam:PassRole\u003c/code\u003e action as demonstrated above.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTest the Policy\u003c/strong\u003e: Attempt to create a Lambda function with an elevated role (e.g., one with \u003ccode\u003eAdministratorAccess\u003c/code\u003e). You should receive an error indicating insufficient permissions.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVerify Changes\u003c/strong\u003e: Ensure that your changes are saved and that the policy displays the new restrictions.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003eTroubleshooting Tips\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eIf you encounter issues applying the modified policy, double-check the ARN for the \u003ccode\u003eSAFE_LAMBDA_EXECUTION_ROLE\u003c/code\u003e for accuracy.\u003c/li\u003e\n\u003cli\u003eEnsure that your IAM user has permission to modify policies; if not, consult your administrator.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eKey Takeaways\u003c/h2\u003e\n\u003cp\u003eToday's lesson underscored the importance of implementing the principle of least privilege in cloud security. By identifying and remediating overly permissive IAM policies, we not only enhance security but also foster a culture of caution and responsibility in cloud resource management. As we progress, remember that vigilance and regular audits are your best defenses against privilege escalation attacks.\u003c/p\u003e\n\u003ch2\u003eReal-World Applications\u003c/h2\u003e\n\u003cp\u003eIn production environments, the lessons learned today are invaluable. Organizations often face the challenge of managing numerous IAM roles and policies. By adhering to the principles discussed, they can significantly reduce their attack surface and protect sensitive resources from unauthorized access. Moreover, implementing these best practices creates a robust security posture that can withstand the evolving threat landscape in cloud environments.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cstrong\u003eJourney Progress:\u003c/strong\u003e 8/100 Days Complete ðŸš€\u003c/p\u003e\n"])</script><script>self.__next_f.push([1,"7:[\"$\",\"article\",null,{\"className\":\"max-w-4xl mx-auto px-4 py-8\",\"children\":[[\"$\",\"header\",null,{\"className\":\"mb-8 text-center\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"font-headline text-3xl md:text-5xl font-bold text-primary mb-3\",\"children\":\"100 Days of Cloud Security - Day 8: Defend - `lambda_privesc`\"}],[\"$\",\"div\",null,{\"className\":\"text-muted-foreground text-sm md:text-base\",\"children\":[[\"$\",\"span\",null,{\"children\":[\"By \",\"Venkata Pathuri\",\" on \"]}],[\"$\",\"time\",null,{\"dateTime\":\"2025-11-17\",\"children\":\"November 17, 2025\"}]]}]]}],[\"$\",\"$L12\",null,{\"className\":\"my-8\"}],[\"$\",\"div\",null,{\"className\":\"prose prose-lg dark:prose-invert max-w-none prose-headings:text-primary prose-a:text-primary\",\"dangerouslySetInnerHTML\":{\"__html\":\"$13\"}}]]}]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n9:null\n"])</script><script>self.__next_f.push([1,"14:I[622,[],\"IconMark\"]\nb:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"100 Days of Cloud Security - Day 8: Defend - `lambda_privesc` | Gitfolio Blogger\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Day 8 of my cloud security journey - Defend - `lambda_privesc`\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"32x32\"}],[\"$\",\"$L14\",\"3\",{}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"10:\"$b:metadata\"\n"])</script></body></html>