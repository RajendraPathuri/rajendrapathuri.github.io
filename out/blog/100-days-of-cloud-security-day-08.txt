1:"$Sreact.fragment"
2:I[1458,["619","static/chunks/619-ba102abea3e3d0e4.js","909","static/chunks/909-740805674b8356ef.js","451","static/chunks/451-c2def8cce98c3140.js","177","static/chunks/app/layout-870cdc0898a1f2e6.js"],"ThemeProvider"]
3:I[6970,["619","static/chunks/619-ba102abea3e3d0e4.js","909","static/chunks/909-740805674b8356ef.js","451","static/chunks/451-c2def8cce98c3140.js","177","static/chunks/app/layout-870cdc0898a1f2e6.js"],"default"]
4:I[9766,[],""]
5:I[8924,[],""]
6:I[704,["619","static/chunks/619-ba102abea3e3d0e4.js","909","static/chunks/909-740805674b8356ef.js","451","static/chunks/451-c2def8cce98c3140.js","177","static/chunks/app/layout-870cdc0898a1f2e6.js"],"Toaster"]
8:I[4431,[],"OutletBoundary"]
a:I[5278,[],"AsyncMetadataOutlet"]
c:I[4431,[],"ViewportBoundary"]
e:I[4431,[],"MetadataBoundary"]
f:"$Sreact.suspense"
11:I[7150,[],""]
:HL["/_next/static/css/646ef98856fbea42.css","style"]
0:{"P":null,"b":"JMtuDo3EXuReSaRmaYdn1","p":"","c":["","blog","100-days-of-cloud-security-day-08"],"i":false,"f":[[["",{"children":["blog",{"children":[["slug","100-days-of-cloud-security-day-08","d"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/646ef98856fbea42.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":[["$","head",null,{"children":[["$","link",null,{"rel":"preconnect","href":"https://fonts.googleapis.com"}],["$","link",null,{"rel":"preconnect","href":"https://fonts.gstatic.com","crossOrigin":""}],["$","link",null,{"href":"https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Fira+Code:wght@400;700&family=Orbitron:wght@400;700&display=swap","rel":"stylesheet"}]]}],["$","body",null,{"className":"font-body antialiased min-h-screen bg-background text-foreground","children":["$","$L2",null,{"attribute":"class","defaultTheme":"system","enableSystem":true,"disableTransitionOnChange":true,"children":[["$","div",null,{"className":"relative flex min-h-dvh flex-col","children":[["$","$L3",null,{}],["$","main",null,{"className":"flex-1 container py-10","children":["$","$L4",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":404}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}],["$","footer",null,{"className":"border-t","children":["$","div",null,{"className":"container flex flex-col items-center justify-center gap-4 py-8 md:h-24 md:flex-row","children":["$","div",null,{"className":"flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0","children":[["$","svg",null,{"ref":"$undefined","xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-cloud-lightning h-6 w-6 text-primary","children":[["$","path","1cez44",{"d":"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973"}],["$","path","1t22er",{"d":"m13 12-3 5h4l-3 5"}],"$undefined"]}],["$","p",null,{"className":"text-center text-sm leading-loose text-muted-foreground md:text-left","children":["Â© ",2025," Venkata Pathuri. All Rights Reserved."]}]]}]}]}]]}],["$","$L6",null,{}]]}]}]]}]]}],{"children":["blog",["$","$1","c",{"children":[null,["$","$L4",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["slug","100-days-of-cloud-security-day-08","d"],["$","$1","c",{"children":[null,["$","$L4",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":["$L7",null,["$","$L8",null,{"children":["$L9",["$","$La",null,{"promise":"$@b"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],["$","$1","h",{"children":[null,[["$","$Lc",null,{"children":"$Ld"}],null],["$","$Le",null,{"children":["$","div",null,{"hidden":true,"children":["$","$f",null,{"fallback":null,"children":"$L10"}]}]}]]}],false]],"m":"$undefined","G":["$11",[]],"s":false,"S":true}
12:I[8474,["909","static/chunks/909-740805674b8356ef.js","953","static/chunks/app/blog/%5Bslug%5D/page-586f9b997c6ba5d5.js"],"Separator"]
13:T1686,<h1>Day 8: Defend - <code>lambda_privesc</code></h1>
<h2>Overview</h2>
<p>Welcome back to Day 8 of our cloud security journey! Today, we delve into the critical area of defending against privilege escalation vulnerabilities, specifically in AWS Lambda environments. Building on our previous discussions about identity and access management (IAM) from Day 7, we will explore how to implement the principle of least privilege effectively to secure your Lambda functions from potential exploitation.</p>
<h2>Learning Objectives</h2>
<p>By the end of this lesson, you will master the art of securely implementing the <code>lambda_privesc</code> scenario. You will learn to identify overly permissive IAM policies and remediate them to prevent privilege escalation. You will also gain insights into crafting IAM policies that align with the principle of least privilege, ensuring that users and roles have only the permissions essential to perform their tasks.</p>
<h2>Deep Dive</h2>
<p>In our analysis, we identified a significant vulnerability in the <code>cg-lambdaManager-policy-cgide3k5k2fwj7</code>, which allowed excessive permissions due to the inclusion of the <code>iam:PassRole</code> action with a wildcard resource (<code>"*"</code>). This configuration could enable an attacker to create a Lambda function with an elevated role, such as <code>AdministratorAccess</code>, leading to potentially catastrophic outcomes.</p>
<h3>Vulnerability Breakdown</h3>
<p>The original policy was structured as follows:</p>
<pre><code class="language-json">{
    "Statement": [
        {
            "Action": [
                "lambda:*",
                "iam:PassRole"
            ],
            "Effect": "Allow",
            "Resource": "*",
            "Sid": "lambdaManager"
        }
    ],
    "Version": "2012-10-17"
}
</code></pre>
<p>The glaring issue here is that it grants the ability to pass any IAM role, which is a common attack vector for privilege escalation in cloud environments.</p>
<h3>Remediation Steps</h3>
<p>To correct this security flaw, we modified the policy to restrict the <code>iam:PassRole</code> action to a designated role, thereby adhering to the principle of least privilege:</p>
<pre><code class="language-json">{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "LambdaActions",
            "Effect": "Allow",
            "Action": "lambda:*",
            "Resource": "*"
        },
        {
            "Sid": "RestrictPassRole",
            "Effect": "Allow",
            "Action": "iam:PassRole",
            "Resource": "arn:aws:iam::ACCOUNT_ID:role/SAFE_LAMBDA_EXECUTION_ROLE"
        }
    ]
}
</code></pre>
<p>This approach mitigates the risk of privilege escalation by ensuring that only the specified <code>SAFE_LAMBDA_EXECUTION_ROLE</code> can be passed, preventing any high-privilege roles from being assigned by users with the <code>lambdaManager</code> role.</p>
<h3>Visual Insights</h3>
<p>As you work through this scenario, you'll see graphical representations of permissions and alerts indicating when a policy is too permissive. These visuals are crucial for understanding the implications of your IAM configurations.</p>
<h3>Current Best Practices</h3>
<ul>
<li><strong>Restrict <code>iam:PassRole</code></strong>: Always limit the roles that can be passed to only those necessary for the Lambda function's operation.</li>
<li><strong>Regularly Audit IAM Policies</strong>: Conduct routine audits of IAM policies to ensure compliance with least privilege principles.</li>
<li><strong>Use Role-based Access Control (RBAC)</strong>: Implement RBAC to manage permissions more effectively and reduce complexity in IAM policies.</li>
</ul>
<h2>Hands-On Practice</h2>
<p>To apply what you've learned, follow these steps in your CloudGoat lab:</p>
<ol>
<li><strong>Access the IAM Policy</strong>: Navigate to the IAM section in the AWS Management Console and locate the <code>cg-lambdaManager-policy</code>.</li>
<li><strong>Modify the Policy</strong>: Edit the policy to restrict the <code>iam:PassRole</code> action as demonstrated above.</li>
<li><strong>Test the Policy</strong>: Attempt to create a Lambda function with an elevated role (e.g., one with <code>AdministratorAccess</code>). You should receive an error indicating insufficient permissions.</li>
<li><strong>Verify Changes</strong>: Ensure that your changes are saved and that the policy displays the new restrictions.</li>
</ol>
<h3>Troubleshooting Tips</h3>
<ul>
<li>If you encounter issues applying the modified policy, double-check the ARN for the <code>SAFE_LAMBDA_EXECUTION_ROLE</code> for accuracy.</li>
<li>Ensure that your IAM user has permission to modify policies; if not, consult your administrator.</li>
</ul>
<h2>Key Takeaways</h2>
<p>Today's lesson underscored the importance of implementing the principle of least privilege in cloud security. By identifying and remediating overly permissive IAM policies, we not only enhance security but also foster a culture of caution and responsibility in cloud resource management. As we progress, remember that vigilance and regular audits are your best defenses against privilege escalation attacks.</p>
<h2>Real-World Applications</h2>
<p>In production environments, the lessons learned today are invaluable. Organizations often face the challenge of managing numerous IAM roles and policies. By adhering to the principles discussed, they can significantly reduce their attack surface and protect sensitive resources from unauthorized access. Moreover, implementing these best practices creates a robust security posture that can withstand the evolving threat landscape in cloud environments.</p>
<hr>
<p><strong>Journey Progress:</strong> 8/100 Days Complete ðŸš€</p>
7:["$","article",null,{"className":"max-w-4xl mx-auto px-4 py-8","children":[["$","header",null,{"className":"mb-8 text-center","children":[["$","h1",null,{"className":"font-headline text-3xl md:text-5xl font-bold text-primary mb-3","children":"100 Days of Cloud Security - Day 8: Defend - `lambda_privesc`"}],["$","div",null,{"className":"text-muted-foreground text-sm md:text-base","children":[["$","span",null,{"children":["By ","Venkata Pathuri"," on "]}],["$","time",null,{"dateTime":"2025-11-17","children":"November 17, 2025"}]]}]]}],["$","$L12",null,{"className":"my-8"}],["$","div",null,{"className":"prose prose-lg dark:prose-invert max-w-none prose-headings:text-primary prose-a:text-primary","dangerouslySetInnerHTML":{"__html":"$13"}}]]}]
d:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
9:null
14:I[622,[],"IconMark"]
b:{"metadata":[["$","title","0",{"children":"100 Days of Cloud Security - Day 8: Defend - `lambda_privesc` | Gitfolio Blogger"}],["$","meta","1",{"name":"description","content":"Day 8 of my cloud security journey - Defend - `lambda_privesc`"}],["$","link","2",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"32x32"}],["$","$L14","3",{}]],"error":null,"digest":"$undefined"}
10:"$b:metadata"
