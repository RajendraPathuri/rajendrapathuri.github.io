<!DOCTYPE html><!--JMtuDo3EXuReSaRmaYdn1--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/646ef98856fbea42.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-ca8ebae7f954b22a.js"/><script src="/_next/static/chunks/4bd1b696-21f374d1156f834a.js" async=""></script><script src="/_next/static/chunks/255-87b65d3beb72be65.js" async=""></script><script src="/_next/static/chunks/main-app-105e7bfa05751db9.js" async=""></script><script src="/_next/static/chunks/619-ba102abea3e3d0e4.js" async=""></script><script src="/_next/static/chunks/909-740805674b8356ef.js" async=""></script><script src="/_next/static/chunks/451-c2def8cce98c3140.js" async=""></script><script src="/_next/static/chunks/app/layout-870cdc0898a1f2e6.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-586f9b997c6ba5d5.js" async=""></script><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""/><title>100 Days of Cloud Security - Day 4: Defend - `sns_secrets` | Gitfolio Blogger</title><meta name="description" content="Day 4 of my cloud security journey - Defend - `sns_secrets`"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="32x32"/><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&amp;family=Fira+Code:wght@400;700&amp;family=Orbitron:wght@400;700&amp;display=swap" rel="stylesheet"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="font-body antialiased min-h-screen bg-background text-foreground"><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("class","theme","system",null,["light","dark"],null,true,true)</script><div class="relative flex min-h-dvh flex-col"><header class="sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60"><div class="w-full px-4 md:px-8 flex h-16 items-center justify-between"><a class="flex items-center gap-2" href="/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cloud-lightning h-6 w-6 text-primary"><path d="M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973"></path><path d="m13 12-3 5h4l-3 5"></path></svg><span class="font-cyber text-xl font-bold text-primary">x0vrpp</span></a><div class="flex items-center gap-6"><nav class="hidden md:flex items-center gap-6"><a class="transition-colors relative text-lg md:text-sm hover:text-primary text-muted-foreground" href="/">About Me</a><a class="transition-colors relative text-lg md:text-sm hover:text-primary text-muted-foreground" href="/certifications">Certifications</a><a class="transition-colors relative text-lg md:text-sm hover:text-primary text-muted-foreground" href="/projects">Projects</a><a class="transition-colors relative text-lg md:text-sm hover:text-primary text-primary font-semibold" href="/blog">Blog<span class="absolute -bottom-2 left-1/2 -translate-x-1/2 w-2 h-2 rounded-full bg-primary hidden md:block"></span></a></nav><div class="hidden md:block"><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground h-9 w-9 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg><span class="sr-only">Toggle theme</span></button></div><div class="flex items-center md:hidden gap-4"><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground h-9 w-9 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg><span class="sr-only">Toggle theme</span></button><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground h-10 w-10" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-_R_n5lb_" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu h-6 w-6"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg><span class="sr-only">Open Menu</span></button></div></div></div></header><main class="flex-1 container py-10"><article class="max-w-4xl mx-auto px-4 py-8"><header class="mb-8 text-center"><h1 class="font-headline text-3xl md:text-5xl font-bold text-primary mb-3">100 Days of Cloud Security - Day 4: Defend - `sns_secrets`</h1><div class="text-muted-foreground text-sm md:text-base"><span>By <!-- -->Venkata Pathuri<!-- --> on </span><time dateTime="2025-11-13">November 13, 2025</time></div></header><div data-orientation="horizontal" role="none" class="shrink-0 bg-border h-[1px] w-full my-8"></div><div class="prose prose-lg dark:prose-invert max-w-none prose-headings:text-primary prose-a:text-primary"><h1>Day 4: Defend - <code>sns_secrets</code></h1>
<h2>Overview</h2>
<p>As we continue our cloud security journey, Day 4 focuses on defending against vulnerabilities specific to AWS services, particularly the interplay between Amazon Simple Notification Service (SNS) and API Gateway. Building on the foundational knowledge of identity and access management (IAM) from Day 3, today we explore how improper assumptions about API Gateway permissions can lead to serious security risks. By identifying and mitigating these vulnerabilities, we take significant steps towards safeguarding our cloud environment.</p>
<h2>Learning Objectives</h2>
<p>Today, we aim to master the art of defending cloud resources by implementing Cloud Security Posture Management (CSPM) strategies. You will learn how to secure SNS subscriptions, enforce stricter API Gateway access controls, and implement logging and monitoring solutions. By the end of this session, youâ€™ll be equipped with practical skills to enhance security in your AWS environment, ensuring that both your APIs and messaging services are robust against unauthorized access.</p>
<h2>Deep Dive</h2>
<h3>Understanding the Vulnerability</h3>
<p>In our scenario, the initial vulnerability arose from the assumption that IAM policies would adequately restrict access to the API Gateway. However, when combined with SNS's inherent permissions, this assumption proved dangerous. Attackers could exploit the <code>sns:Subscribe</code> and <code>apigateway:GET</code> actions, gaining unauthorized access to sensitive information.</p>
<h3>Best Practices for Mitigation</h3>
<ol>
<li>
<p><strong>Explicit Deny Policies</strong>: By applying explicit deny policies for actions like <code>sns:Subscribe</code> and <code>sns:Publish</code>, we can prevent unauthorized users from interacting with our SNS topics. This is a critical first step in creating a secure messaging environment.</p>
</li>
<li>
<p><strong>Resource-Based Policies</strong>: In addition to IAM policies, implementing resource-based policies for both SNS and API Gateway enhances security. These policies ensure that only authorized resources can invoke actions on the topics and APIs.</p>
</li>
<li>
<p><strong>CloudTrail and Logging</strong>: Enabling CloudTrail provides comprehensive logging for all API calls, offering visibility into who accessed what and when. This is vital for compliance and incident response.</p>
</li>
<li>
<p><strong>Encryption with KMS</strong>: Utilizing AWS Key Management Service (KMS) for server-side encryption of SNS messages protects the confidentiality of sensitive data.</p>
</li>
<li>
<p><strong>Web Application Firewall (WAF)</strong>: Integrating WAF with the API Gateway adds another layer of protection by filtering harmful web traffic and controlling access to the APIs.</p>
</li>
</ol>
<h3>Visual Description</h3>
<p>Imagine your AWS console filled with resources neatly organized, each protected by layers of security. You see CloudTrail logs capturing every event, WAF rules in place filtering malicious requests, and encrypted SNS topics ensuring that sensitive messages remain confidential. This structured defense not only secures your environment but also builds a resilient architecture against attacks.</p>
<h2>Hands-On Practice</h2>
<p>Hereâ€™s how to implement the security measures discussed:</p>
<ol>
<li>
<p><strong>Run Security Assessments</strong>: Start by running Prowler and ScoutSuite against your AWS account to identify vulnerabilities.</p>
</li>
<li>
<p><strong>Modify IAM Policies</strong>: Use the following JSON structure to update your IAM policies:</p>
<pre><code class="language-json">{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "AllowSafeSnsAndBasicIamList",
      "Effect": "Allow",
      "Action": [
        "sns:ListTopics",
        "sns:GetTopicAttributes",
        "sns:ListSubscriptionsByTopic",
        "sns:ListSubscriptions",
        "iam:ListUsers",
        "iam:GetUser",
        "iam:ListRoles"
      ],
      "Resource": "*"
    },
    {
      "Sid": "ExplicitDeny_SnsSubscribePublishReceiveSetAttrs",
      "Effect": "Deny",
      "Action": [
        "sns:Subscribe",
        "sns:ConfirmSubscription",
        "sns:SetSubscriptionAttributes",
        "sns:Unsubscribe",
        "sns:Publish",
        "sns:Receive"
      ],
      "Resource": "*"
    },
    {
      "Sid": "ExplicitDeny_ApiGateway_ApiKeyAndIntegrationAccess",
      "Effect": "Deny",
      "Action": [
        "apigateway:GET",
        "apigateway:PUT",
        "apigateway:POST",
        "apigateway:DELETE"
      ],
      "Resource": [
        "arn:aws:apigateway:*::/apikeys",
        "arn:aws:apigateway:*::/apikeys/*",
        "arn:aws:apigateway:*::/restapis/*/resources/*/methods/*/integration",
        "arn:aws:apigateway:*::/restapis/*/integration",
        "arn:aws:apigateway:*::/restapis/*/methods/*"
      ]
    },
    {
      "Sid": "AllowCloudTrailReadIfNeeded",
      "Effect": "Allow",
      "Action": [
        "cloudtrail:LookupEvents"
      ],
      "Resource": "*"
    }
  ]
}
</code></pre>
</li>
<li>
<p><strong>Enable CloudTrail and Logging</strong>: In the console, navigate to CloudTrail and API Gateway settings to enable logging.</p>
</li>
<li>
<p><strong>Set Up CloudWatch Alarms</strong>: Deploy metrics and alarms in CloudWatch to monitor API usage and SNS message handling.</p>
</li>
<li>
<p><strong>Encrypt SNS Topics</strong>: Use the AWS KMS console to enable server-side encryption for your SNS topics.</p>
</li>
</ol>
<h3>Expected Outcomes</h3>
<p>Once you've implemented these measures, you should see heightened security against unauthorized access attempts, logged activities in CloudTrail, and encrypted messages in your SNS topics.</p>
<h3>Common Troubleshooting Tips</h3>
<ul>
<li>If you encounter access denied errors, double-check your IAM policies for correct resource ARNs and permissions.</li>
<li>Ensure that CloudTrail is correctly configured to capture all management events.</li>
<li>Review WAF logs to identify any blocked requests that may need adjustment.</li>
</ul>
<h2>Key Takeaways</h2>
<p>Today, we reinforced the importance of multi-layered security in cloud environments. Relying solely on IAM policies is insufficient; instead, we must integrate resource-based policies, robust logging, and encryption mechanisms. This holistic approach not only mitigates risks but also enhances our ability to respond to incidents effectively.</p>
<h2>Real-World Applications</h2>
<p>In production environments, the lessons learned today translate into tangible security improvements. Organizations handling sensitive user data or critical business processes must adopt these practices to prevent data leaks and unauthorized access. For example, a financial services company might implement similar strategies to secure customer notifications and API endpoints, ensuring compliance with regulatory requirements while providing a secure user experience.</p>
<hr>
<p><strong>Journey Progress:</strong> 4/100 Days Complete ðŸš€</p>
</div></article><!--$--><!--/$--></main><footer class="border-t"><div class="container flex flex-col items-center justify-center gap-4 py-8 md:h-24 md:flex-row"><div class="flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cloud-lightning h-6 w-6 text-primary"><path d="M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973"></path><path d="m13 12-3 5h4l-3 5"></path></svg><p class="text-center text-sm leading-loose text-muted-foreground md:text-left">Â© <!-- -->2025<!-- --> Venkata Pathuri. All Rights Reserved.</p></div></div></footer></div><div role="region" aria-label="Notifications (F8)" tabindex="-1" style="pointer-events:none"><ol tabindex="-1" class="fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]"></ol></div><script src="/_next/static/chunks/webpack-ca8ebae7f954b22a.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[1458,[\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"909\",\"static/chunks/909-740805674b8356ef.js\",\"451\",\"static/chunks/451-c2def8cce98c3140.js\",\"177\",\"static/chunks/app/layout-870cdc0898a1f2e6.js\"],\"ThemeProvider\"]\n3:I[6970,[\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"909\",\"static/chunks/909-740805674b8356ef.js\",\"451\",\"static/chunks/451-c2def8cce98c3140.js\",\"177\",\"static/chunks/app/layout-870cdc0898a1f2e6.js\"],\"default\"]\n4:I[9766,[],\"\"]\n5:I[8924,[],\"\"]\n6:I[704,[\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"909\",\"static/chunks/909-740805674b8356ef.js\",\"451\",\"static/chunks/451-c2def8cce98c3140.js\",\"177\",\"static/chunks/app/layout-870cdc0898a1f2e6.js\"],\"Toaster\"]\n8:I[4431,[],\"OutletBoundary\"]\na:I[5278,[],\"AsyncMetadataOutlet\"]\nc:I[4431,[],\"ViewportBoundary\"]\ne:I[4431,[],\"MetadataBoundary\"]\nf:\"$Sreact.suspense\"\n11:I[7150,[],\"\"]\n:HL[\"/_next/static/css/646ef98856fbea42.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"JMtuDo3EXuReSaRmaYdn1\",\"p\":\"\",\"c\":[\"\",\"blog\",\"100-days-of-cloud-security-day-04\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"100-days-of-cloud-security-day-04\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/646ef98856fbea42.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.googleapis.com\"}],[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.gstatic.com\",\"crossOrigin\":\"\"}],[\"$\",\"link\",null,{\"href\":\"https://fonts.googleapis.com/css2?family=Inter:wght@400;700\u0026family=Fira+Code:wght@400;700\u0026family=Orbitron:wght@400;700\u0026display=swap\",\"rel\":\"stylesheet\"}]]}],[\"$\",\"body\",null,{\"className\":\"font-body antialiased min-h-screen bg-background text-foreground\",\"children\":[\"$\",\"$L2\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[[\"$\",\"div\",null,{\"className\":\"relative flex min-h-dvh flex-col\",\"children\":[[\"$\",\"$L3\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex-1 container py-10\",\"children\":[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"footer\",null,{\"className\":\"border-t\",\"children\":[\"$\",\"div\",null,{\"className\":\"container flex flex-col items-center justify-center gap-4 py-8 md:h-24 md:flex-row\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-cloud-lightning h-6 w-6 text-primary\",\"children\":[[\"$\",\"path\",\"1cez44\",{\"d\":\"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973\"}],[\"$\",\"path\",\"1t22er\",{\"d\":\"m13 12-3 5h4l-3 5\"}],\"$undefined\"]}],[\"$\",\"p\",null,{\"className\":\"text-center text-sm leading-loose text-muted-foreground md:text-left\",\"children\":[\"Â© \",2025,\" Venkata Pathuri. All Rights Reserved.\"]}]]}]}]}]]}],[\"$\",\"$L6\",null,{}]]}]}]]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"100-days-of-cloud-security-day-04\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L7\",null,[\"$\",\"$L8\",null,{\"children\":[\"$L9\",[\"$\",\"$La\",null,{\"promise\":\"$@b\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],null],[\"$\",\"$Le\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$f\",null,{\"fallback\":null,\"children\":\"$L10\"}]}]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$11\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"12:I[8474,[\"909\",\"static/chunks/909-740805674b8356ef.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-586f9b997c6ba5d5.js\"],\"Separator\"]\n13:T1b92,"])</script><script>self.__next_f.push([1,"\u003ch1\u003eDay 4: Defend - \u003ccode\u003esns_secrets\u003c/code\u003e\u003c/h1\u003e\n\u003ch2\u003eOverview\u003c/h2\u003e\n\u003cp\u003eAs we continue our cloud security journey, Day 4 focuses on defending against vulnerabilities specific to AWS services, particularly the interplay between Amazon Simple Notification Service (SNS) and API Gateway. Building on the foundational knowledge of identity and access management (IAM) from Day 3, today we explore how improper assumptions about API Gateway permissions can lead to serious security risks. By identifying and mitigating these vulnerabilities, we take significant steps towards safeguarding our cloud environment.\u003c/p\u003e\n\u003ch2\u003eLearning Objectives\u003c/h2\u003e\n\u003cp\u003eToday, we aim to master the art of defending cloud resources by implementing Cloud Security Posture Management (CSPM) strategies. You will learn how to secure SNS subscriptions, enforce stricter API Gateway access controls, and implement logging and monitoring solutions. By the end of this session, youâ€™ll be equipped with practical skills to enhance security in your AWS environment, ensuring that both your APIs and messaging services are robust against unauthorized access.\u003c/p\u003e\n\u003ch2\u003eDeep Dive\u003c/h2\u003e\n\u003ch3\u003eUnderstanding the Vulnerability\u003c/h3\u003e\n\u003cp\u003eIn our scenario, the initial vulnerability arose from the assumption that IAM policies would adequately restrict access to the API Gateway. However, when combined with SNS's inherent permissions, this assumption proved dangerous. Attackers could exploit the \u003ccode\u003esns:Subscribe\u003c/code\u003e and \u003ccode\u003eapigateway:GET\u003c/code\u003e actions, gaining unauthorized access to sensitive information.\u003c/p\u003e\n\u003ch3\u003eBest Practices for Mitigation\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eExplicit Deny Policies\u003c/strong\u003e: By applying explicit deny policies for actions like \u003ccode\u003esns:Subscribe\u003c/code\u003e and \u003ccode\u003esns:Publish\u003c/code\u003e, we can prevent unauthorized users from interacting with our SNS topics. This is a critical first step in creating a secure messaging environment.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eResource-Based Policies\u003c/strong\u003e: In addition to IAM policies, implementing resource-based policies for both SNS and API Gateway enhances security. These policies ensure that only authorized resources can invoke actions on the topics and APIs.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eCloudTrail and Logging\u003c/strong\u003e: Enabling CloudTrail provides comprehensive logging for all API calls, offering visibility into who accessed what and when. This is vital for compliance and incident response.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eEncryption with KMS\u003c/strong\u003e: Utilizing AWS Key Management Service (KMS) for server-side encryption of SNS messages protects the confidentiality of sensitive data.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eWeb Application Firewall (WAF)\u003c/strong\u003e: Integrating WAF with the API Gateway adds another layer of protection by filtering harmful web traffic and controlling access to the APIs.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003eVisual Description\u003c/h3\u003e\n\u003cp\u003eImagine your AWS console filled with resources neatly organized, each protected by layers of security. You see CloudTrail logs capturing every event, WAF rules in place filtering malicious requests, and encrypted SNS topics ensuring that sensitive messages remain confidential. This structured defense not only secures your environment but also builds a resilient architecture against attacks.\u003c/p\u003e\n\u003ch2\u003eHands-On Practice\u003c/h2\u003e\n\u003cp\u003eHereâ€™s how to implement the security measures discussed:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eRun Security Assessments\u003c/strong\u003e: Start by running Prowler and ScoutSuite against your AWS account to identify vulnerabilities.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eModify IAM Policies\u003c/strong\u003e: Use the following JSON structure to update your IAM policies:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-json\"\u003e{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AllowSafeSnsAndBasicIamList\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sns:ListTopics\",\n        \"sns:GetTopicAttributes\",\n        \"sns:ListSubscriptionsByTopic\",\n        \"sns:ListSubscriptions\",\n        \"iam:ListUsers\",\n        \"iam:GetUser\",\n        \"iam:ListRoles\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"ExplicitDeny_SnsSubscribePublishReceiveSetAttrs\",\n      \"Effect\": \"Deny\",\n      \"Action\": [\n        \"sns:Subscribe\",\n        \"sns:ConfirmSubscription\",\n        \"sns:SetSubscriptionAttributes\",\n        \"sns:Unsubscribe\",\n        \"sns:Publish\",\n        \"sns:Receive\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"ExplicitDeny_ApiGateway_ApiKeyAndIntegrationAccess\",\n      \"Effect\": \"Deny\",\n      \"Action\": [\n        \"apigateway:GET\",\n        \"apigateway:PUT\",\n        \"apigateway:POST\",\n        \"apigateway:DELETE\"\n      ],\n      \"Resource\": [\n        \"arn:aws:apigateway:*::/apikeys\",\n        \"arn:aws:apigateway:*::/apikeys/*\",\n        \"arn:aws:apigateway:*::/restapis/*/resources/*/methods/*/integration\",\n        \"arn:aws:apigateway:*::/restapis/*/integration\",\n        \"arn:aws:apigateway:*::/restapis/*/methods/*\"\n      ]\n    },\n    {\n      \"Sid\": \"AllowCloudTrailReadIfNeeded\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudtrail:LookupEvents\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eEnable CloudTrail and Logging\u003c/strong\u003e: In the console, navigate to CloudTrail and API Gateway settings to enable logging.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eSet Up CloudWatch Alarms\u003c/strong\u003e: Deploy metrics and alarms in CloudWatch to monitor API usage and SNS message handling.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eEncrypt SNS Topics\u003c/strong\u003e: Use the AWS KMS console to enable server-side encryption for your SNS topics.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003eExpected Outcomes\u003c/h3\u003e\n\u003cp\u003eOnce you've implemented these measures, you should see heightened security against unauthorized access attempts, logged activities in CloudTrail, and encrypted messages in your SNS topics.\u003c/p\u003e\n\u003ch3\u003eCommon Troubleshooting Tips\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eIf you encounter access denied errors, double-check your IAM policies for correct resource ARNs and permissions.\u003c/li\u003e\n\u003cli\u003eEnsure that CloudTrail is correctly configured to capture all management events.\u003c/li\u003e\n\u003cli\u003eReview WAF logs to identify any blocked requests that may need adjustment.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eKey Takeaways\u003c/h2\u003e\n\u003cp\u003eToday, we reinforced the importance of multi-layered security in cloud environments. Relying solely on IAM policies is insufficient; instead, we must integrate resource-based policies, robust logging, and encryption mechanisms. This holistic approach not only mitigates risks but also enhances our ability to respond to incidents effectively.\u003c/p\u003e\n\u003ch2\u003eReal-World Applications\u003c/h2\u003e\n\u003cp\u003eIn production environments, the lessons learned today translate into tangible security improvements. Organizations handling sensitive user data or critical business processes must adopt these practices to prevent data leaks and unauthorized access. For example, a financial services company might implement similar strategies to secure customer notifications and API endpoints, ensuring compliance with regulatory requirements while providing a secure user experience.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cstrong\u003eJourney Progress:\u003c/strong\u003e 4/100 Days Complete ðŸš€\u003c/p\u003e\n"])</script><script>self.__next_f.push([1,"7:[\"$\",\"article\",null,{\"className\":\"max-w-4xl mx-auto px-4 py-8\",\"children\":[[\"$\",\"header\",null,{\"className\":\"mb-8 text-center\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"font-headline text-3xl md:text-5xl font-bold text-primary mb-3\",\"children\":\"100 Days of Cloud Security - Day 4: Defend - `sns_secrets`\"}],[\"$\",\"div\",null,{\"className\":\"text-muted-foreground text-sm md:text-base\",\"children\":[[\"$\",\"span\",null,{\"children\":[\"By \",\"Venkata Pathuri\",\" on \"]}],[\"$\",\"time\",null,{\"dateTime\":\"2025-11-13\",\"children\":\"November 13, 2025\"}]]}]]}],[\"$\",\"$L12\",null,{\"className\":\"my-8\"}],[\"$\",\"div\",null,{\"className\":\"prose prose-lg dark:prose-invert max-w-none prose-headings:text-primary prose-a:text-primary\",\"dangerouslySetInnerHTML\":{\"__html\":\"$13\"}}]]}]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n9:null\n"])</script><script>self.__next_f.push([1,"14:I[622,[],\"IconMark\"]\nb:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"100 Days of Cloud Security - Day 4: Defend - `sns_secrets` | Gitfolio Blogger\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Day 4 of my cloud security journey - Defend - `sns_secrets`\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"32x32\"}],[\"$\",\"$L14\",\"3\",{}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"10:\"$b:metadata\"\n"])</script></body></html>